<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>æ—¶é—´ç®¡ç†çº¿æ€§è§„åˆ’å¯è§†åŒ–ç³»ç»Ÿ</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        /* åŸºç¡€æ ·å¼ */
        body { font-family: 'Microsoft YaHei', sans-serif; margin: 0; padding: 0; background: #f5f7fa; color: #333; }
        * { box-sizing: border-box; }
        
        /* å¸ƒå±€ç»“æ„ */
        .app-container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        .app-header { background: #1890ff; color: white; padding: 15px 20px; border-radius: 8px 8px 0 0; margin-bottom: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .app-header h1 { margin: 0; font-size: 24px; }
        .app-header p { margin: 5px 0 0; opacity: 0.8; font-size: 14px; }
        
        .main-content { display: grid; grid-template-columns: 350px 1fr; gap: 20px; }
        
        /* ä¾§è¾¹æ å¯¼èˆª */
        .sidebar { background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.08); overflow: hidden; }
        
        /* æ­¥éª¤å¯¼èˆª */
        .steps-nav { list-style: none; margin: 0; padding: 0; }
        .step-item { border-bottom: 1px solid #f0f0f0; }
        .step-button { display: flex; align-items: center; padding: 15px 20px; width: 100%; text-align: left; background: none; border: none; cursor: pointer; transition: all 0.3s; }
        .step-button:hover { background: #f5f5f5; }
        .step-button.active { background: #e6f7ff; border-left: 3px solid #1890ff; }
        .step-number { width: 28px; height: 28px; border-radius: 50%; background: #f0f0f0; color: #333; display: flex; align-items: center; justify-content: center; margin-right: 12px; font-weight: bold; }
        .step-button.active .step-number { background: #1890ff; color: white; }
        .step-button.completed .step-number { background: #52c41a; color: white; }
        .step-info { flex: 1; }
        .step-title { font-weight: 500; font-size: 16px; margin-bottom: 3px; }
        .step-desc { font-size: 12px; color: #888; margin: 0; }
        .step-status { margin-left: auto; color: #999; font-size: 12px; }
        .step-button.active .step-status { color: #1890ff; }
        .step-button.completed .step-status { color: #52c41a; }
        
        /* å†…å®¹é¢æ¿ */
        .content-panel { background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.08); overflow: hidden; }
        .panel-header { padding: 15px 20px; background: #fafafa; border-bottom: 1px solid #f0f0f0; }
        .panel-header h2 { margin: 0; font-size: 18px; color: #1890ff; }
        .panel-header p { margin: 5px 0 0; color: #888; font-size: 14px; }
        .panel-body { padding: 20px; }
        
        /* é¢æ¿å†…å®¹åŒºåŸŸ */
        .step-content { display: none; }
        .step-content.active { display: block; }
        
        /* å›¾è¡¨åŒºåŸŸ */
        .chart-container { height: 450px; margin-top: 20px; background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.08); position: relative; }
        #chart { width: 100%; height: 100%; }
        
        /* æ§ä»¶æ ·å¼ */
        .control-group { margin-bottom: 20px; }
        .control-group:last-child { margin-bottom: 0; }
        .control-group h3 { margin: 0 0 15px; font-size: 16px; color: #333; display: flex; align-items: center; }
        .control-group h3 .icon { margin-right: 8px; color: #1890ff; }
        
        /* è¾“å…¥æ§ä»¶ */
        .input-row { display: flex; align-items: center; margin-bottom: 12px; }
        .input-row:last-child { margin-bottom: 0; }
        .input-label { width: 80px; font-weight: 500; font-size: 14px; color: #333; }
        .input-control { flex: 1; display: flex; align-items: center; }
        
        input[type="range"] { 
            appearance: none; 
            height: 6px; 
            background: #e1e1e1; 
            border-radius: 3px; 
            flex: 1; 
            margin: 0; 
            position: relative;
            cursor: pointer;
        }
        input[type="range"]::-webkit-slider-thumb {
            appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #1890ff;
            cursor: pointer;
            border: none;
            box-shadow: 0 0 5px rgba(24, 144, 255, 0.5);
        }
        
        input[type="number"] {
            width: 60px;
            margin-left: 10px;
            padding: 6px 10px;
            border: 1px solid #d9d9d9;
            border-radius: 4px;
            text-align: center;
            font-size: 14px;
        }
        
        /* é€‰é¡¹å¡ */
        .tabs { display: flex; border-bottom: 1px solid #f0f0f0; background: #fafafa; }
        .tab-button { padding: 12px 20px; background: none; border: none; cursor: pointer; font-size: 14px; color: #666; position: relative; transition: all 0.3s; }
        .tab-button:hover { color: #40a9ff; }
        .tab-button.active { color: #1890ff; }
        .tab-button.active::after { content: ''; position: absolute; bottom: 0; left: 0; right: 0; height: 2px; background: #1890ff; }
        
        .tab-content { padding: 20px; display: none; }
        .tab-content.active { display: block; }
        
        /* æŒ‰é’®æ ·å¼ */
        .btn-row { display: flex; gap: 10px; margin-top: 20px; }
        .btn { padding: 8px 16px; border-radius: 4px; border: none; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.3s; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .btn-primary { background: #1890ff; color: white; }
        .btn-primary:hover { background: #40a9ff; }
        .btn-success { background: #52c41a; color: white; }
        .btn-success:hover { background: #73d13d; }
        .btn-danger { background: #ff4d4f; color: white; }
        .btn-danger:hover { background: #ff7875; }
        .btn-secondary { background: #f0f0f0; color: #333; }
        .btn-secondary:hover { background: #d9d9d9; }
        
        /* å¡ç‰‡æ ·å¼ */
        .card { background: #f9f9f9; border-radius: 6px; padding: 15px; margin-bottom: 15px; position: relative; overflow: hidden; }
        .card-title { font-weight: 600; margin: 0 0 10px; font-size: 15px; color: #333; }
        .card p { margin: 0 0 8px; font-size: 14px; color: #666; }
        .card p:last-child { margin-bottom: 0; }
        .card.active { background: #e6f7ff; }
        .card.completed { background: #f6ffed; border-left: 3px solid #52c41a; }
        
        /* å›¾ä¾‹é¡¹ç›® */
        .legend-item { display: flex; align-items: center; margin-bottom: 8px; }
        .legend-color { width: 14px; height: 14px; border-radius: 50%; margin-right: 8px; }
        .legend-text { font-size: 14px; color: #666; }
        
        /* æ´»åŠ¨æ ‡ç­¾ */
        .activity-tag { display: inline-flex; align-items: center; padding: 3px 8px; border-radius: 4px; font-size: 12px; font-weight: 500; margin-right: 8px; margin-bottom: 8px; }
        .tag-main { background: rgba(24, 144, 255, 0.1); color: #1890ff; }
        .tag-other { background: rgba(82, 196, 26, 0.1); color: #52c41a; }
        .tag-exercise { background: rgba(250, 173, 20, 0.1); color: #faad14; }
        .tag-relax { background: rgba(255, 77, 79, 0.1); color: #ff4d4f; }
        
        /* æ—¶é—´æ¡æ ·å¼ */
        .time-bar-container { margin-top: 15px; }
        .time-bar { height: 36px; border-radius: 6px; overflow: hidden; display: flex; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
        .time-segment { display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; transition: width 0.5s ease; }
        .segment-main { background: #1890ff; }
        .segment-other { background: #52c41a; }
        .segment-exercise { background: #faad14; }
        .segment-relax { background: #ff4d4f; }
        
        .time-scale { display: flex; justify-content: space-between; margin-top: 5px; font-size: 12px; color: #888; }
        
        /* åŠ è½½çŠ¶æ€ */
        .loading-overlay { position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(255,255,255,0.8); display: flex; align-items: center; justify-content: center; z-index: 100; display: none; }
        .loading-spinner { width: 40px; height: 40px; border: 3px solid #f3f3f3; border-top: 3px solid #1890ff; border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        /* å·¥å…·æç¤º */
        .tooltip { position: absolute; background: rgba(0,0,0,0.8); color: white; padding: 5px 10px; border-radius: 4px; font-size: 12px; z-index: 1000; pointer-events: none; white-space: nowrap; }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .main-content { grid-template-columns: 1fr; }
            .chart-container { height: 350px; }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- åº”ç”¨æ ‡é¢˜ -->
        <header class="app-header">
            <h1>æ—¶é—´ç®¡ç†çº¿æ€§è§„åˆ’ç³»ç»Ÿ</h1>
            <p>è®©æ•°å­¦å¸®ä½ åšå‡ºæœ€ä¼˜çš„æ—¶é—´åˆ†é…å†³ç­–</p>
        </header>
        
        <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
        <div class="main-content">
            <!-- ä¾§è¾¹å¯¼èˆª -->
            <aside class="sidebar">
                <ul class="steps-nav">
                    <li class="step-item">
                        <button class="step-button active" onclick="switchStep(1)">
                            <div class="step-number">1</div>
                            <div class="step-info">
                                <div class="step-title">è®¾ç½®çº¦æŸæ¡ä»¶</div>
                                <p class="step-desc">å®šä¹‰å­¦ä¹ æ—¶é—´çš„çº¦æŸ</p>
                            </div>
                            <div class="step-status">è¿›è¡Œä¸­</div>
                        </button>
                    </li>
                    <li class="step-item">
                        <button class="step-button" onclick="switchStep(2)">
                            <div class="step-number">2</div>
                            <div class="step-info">
                                <div class="step-title">å®šä¹‰æ•ˆèƒ½ç³»æ•°</div>
                                <p class="step-desc">è®¾ç½®æ´»åŠ¨çš„ä»·å€¼æƒé‡</p>
                            </div>
                            <div class="step-status">å¾…å®Œæˆ</div>
                        </button>
                    </li>
                    <li class="step-item">
                        <button class="step-button" onclick="switchStep(3)">
                            <div class="step-number">3</div>
                            <div class="step-info">
                                <div class="step-title">æ¢ç´¢å¯è¡ŒåŸŸ</div>
                                <p class="step-desc">æŸ¥çœ‹æ‰€æœ‰å¯èƒ½çš„æ—¶é—´åˆ†é…</p>
                            </div>
                            <div class="step-status">å¾…å®Œæˆ</div>
                        </button>
                    </li>
                    <li class="step-item">
                        <button class="step-button" onclick="switchStep(4)">
                            <div class="step-number">4</div>
                            <div class="step-info">
                                <div class="step-title">å¯»æ‰¾æœ€ä¼˜è§£</div>
                                <p class="step-desc">ç¡®å®šæœ€ä¼˜æ—¶é—´åˆ†é…æ–¹æ¡ˆ</p>
                            </div>
                            <div class="step-status">å¾…å®Œæˆ</div>
                        </button>
                    </li>
                    <li class="step-item">
                        <button class="step-button" onclick="switchStep(5)">
                            <div class="step-number">5</div>
                            <div class="step-info">
                                <div class="step-title">é«˜çº§æ¢ç´¢</div>
                                <p class="step-desc">è‡ªå®šä¹‰åˆ†æä¸æ·±å…¥ç ”ç©¶</p>
                            </div>
                            <div class="step-status">å¾…å®Œæˆ</div>
                        </button>
                    </li>
                </ul>
                
                <!-- åº•éƒ¨çŸ¥è¯†ç‚¹æç¤º -->
                <div style="padding: 15px; background: #fffbe6; border-top: 1px solid #f0f0f0;">
                    <h3 style="margin: 0 0 10px; font-size: 14px; color: #d48806;">ğŸ’¡ çŸ¥è¯†ç‚¹æç¤º</h3>
                    <p style="margin: 0; font-size: 12px; color: #666; line-height: 1.5;">
                        çº¿æ€§è§„åˆ’æ˜¯ç ”ç©¶åœ¨çº¦æŸæ¡ä»¶ä¸‹å¯»æ‰¾ç›®æ ‡å‡½æ•°æœ€ä¼˜å€¼çš„æ•°å­¦æ–¹æ³•ã€‚åœ¨æœ¬ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬é€šè¿‡å¯è§†åŒ–å±•ç¤ºå¦‚ä½•åœ¨æœ‰é™æ—¶é—´å†…åšå‡ºæœ€ä¼˜åˆ†é…ã€‚
                    </p>
                </div>
            </aside>
            
            <!-- å†…å®¹é¢æ¿ -->
            <main class="content-panel">
                <!-- æ­¥éª¤1ï¼šè®¾ç½®çº¦æŸæ¡ä»¶ -->
                <div class="step-content active" id="step-content-1">
                    <div class="panel-header">
                        <h2>æ­¥éª¤1ï¼šè®¾ç½®å­¦ä¹ æ—¶é—´çº¦æŸ</h2>
                        <p>è®¾å®šå„ç§‘ç›®çš„æœ€ä½å­¦ä¹ æ—¶é—´è¦æ±‚ï¼Œæ€»å¯ç”¨æ—¶é—´é»˜è®¤ä¸º4å°æ—¶</p>
                    </div>
                    
                    <div class="panel-body">
                        <div class="card active">
                            <div class="card-title">â±ï¸ è®¾ç½®å­¦ä¹ æ—¶é—´çº¦æŸ</div>
                            <p>è°ƒæ•´ä»¥ä¸‹æ»‘å—æ¥è®¾ç½®ä¸åŒå­¦ç§‘çš„æœ€ä½å­¦ä¹ æ—¶é—´è¦æ±‚ï¼š</p>
                            
                            <div class="input-row">
                                <div class="input-label">ä¸»ç§‘æ—¶é—´:</div>
                                <div class="input-control">
                                    <input type="range" id="mainSubject" min="0.5" max="3" value="1.5" step="0.1" oninput="updateMainSubject(this.value)">
                                    <input type="number" id="mainSubjectInput" min="0.5" max="3" value="1.5" step="0.1" onchange="updateMainSubject(this.value)">
                                    <span style="margin-left: 5px;">å°æ—¶</span>
                                </div>
                            </div>
                            
                            <div class="input-row">
                                <div class="input-label">ç»¼åˆç§‘ç›®:</div>
                                <div class="input-control">
                                    <input type="range" id="otherSubject" min="0.5" max="3" value="1" step="0.1" oninput="updateOtherSubject(this.value)">
                                    <input type="number" id="otherSubjectInput" min="0.5" max="3" value="1" step="0.1" onchange="updateOtherSubject(this.value)">
                                    <span style="margin-left: 5px;">å°æ—¶</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-title">ğŸ“Œ å›ºå®šæ´»åŠ¨æ—¶é—´</div>
                            <p>ä»¥ä¸‹æ´»åŠ¨æ—¶é—´ä¸ºå›ºå®šå€¼ï¼Œä¸å¯è°ƒæ•´ï¼š</p>
                            
                            <div style="display: flex; flex-wrap: wrap; margin-top: 10px;">
                                <div class="activity-tag tag-exercise">
                                    <span style="width: 8px; height: 8px; border-radius: 50%; background: #faad14; margin-right: 5px;"></span>
                                    è¿åŠ¨è§£å‹: 0.5å°æ—¶
                                </div>
                                <div class="activity-tag tag-relax">
                                    <span style="width: 8px; height: 8px; border-radius: 50%; background: #ff4d4f; margin-right: 5px;"></span>
                                    å……ç”µæ”¾æ¾: 0.5å°æ—¶
                                </div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-title">ğŸ” çº¦æŸæ¡ä»¶è¯´æ˜</div>
                            <div style="margin-top: 10px;">
                                <div class="legend-item">
                                    <div class="legend-color" style="background: #ff4d4f;"></div>
                                    <div class="legend-text">æ€»æ—¶é—´çº¦æŸ: x + y + 1 â‰¤ 4ï¼ˆå³x + y â‰¤ 3ï¼‰</div>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background: #1890ff;"></div>
                                    <div class="legend-text">ä¸»ç§‘æ—¶é—´ä¸‹é™: x â‰¥ <span id="main-min-value">1.5</span></div>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background: #52c41a;"></div>
                                    <div class="legend-text">ç»¼åˆç§‘ç›®ä¸‹é™: y â‰¥ <span id="other-min-value">1</span></div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- å›¾è¡¨å®¹å™¨ -->
                        <div class="chart-container">
                            <div id="chart"></div>
                            <div class="loading-overlay" id="loading-overlay">
                                <div class="loading-spinner"></div>
                            </div>
                        </div>
                        
                        <!-- ä¸‹ä¸€æ­¥æŒ‰é’® -->
                        <div class="btn-row">
                            <button class="btn btn-secondary" disabled>ä¸Šä¸€æ­¥</button>
                            <button class="btn btn-primary" onclick="nextStep()">ä¸‹ä¸€æ­¥</button>
                        </div>
                    </div>
                </div>
                
                <!-- æ­¥éª¤2ï¼šå®šä¹‰æ•ˆèƒ½ç³»æ•° -->
                <div class="step-content" id="step-content-2">
                    <div class="panel-header">
                        <h2>æ­¥éª¤2ï¼šå®šä¹‰æ•ˆèƒ½ç³»æ•°</h2>
                        <p>è®¾ç½®å„ç±»æ´»åŠ¨çš„ä»·å€¼æƒé‡ï¼Œå½±å“æœ€ç»ˆçš„æœ€ä¼˜è§£</p>
                    </div>
                    
                    <div class="panel-body">
                        <div class="card active">
                            <div class="card-title">ğŸ¯ è®¾ç½®æ´»åŠ¨æ•ˆèƒ½ç³»æ•°</div>
                            <p>æ ¹æ®ä¸ªäººåå¥½ï¼Œä¸ºæ¯ç§æ´»åŠ¨è®¾ç½®1-10åˆ†çš„æ•ˆèƒ½ç³»æ•°ï¼š</p>
                            
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-top: 15px;">
                                <div style="background: #f0f7ff; padding: 12px; border-radius: 6px;">
                                    <div style="display: flex; align-items: center; margin-bottom: 8px;">
                                        <div style="width: 12px; height: 12px; border-radius: 50%; background: #1890ff; margin-right: 8px;"></div>
                                        <span style="font-weight: 500; flex: 1;">ä¸»ç§‘å†²åˆº</span>
                                    </div>
                                    <div style="display: flex; align-items: center;">
                                        <input type="range" id="mainCoeff" min="1" max="10" value="9" step="1" style="flex: 1;" oninput="updateCoefficients()">
                                        <input type="number" id="mainCoeffInput" min="1" max="10" value="9" style="width: 50px; margin-left: 10px;" onchange="updateCoefficients()">
                                    </div>
                                </div>
                                
                                <div style="background: #f0fff7; padding: 12px; border-radius: 6px;">
                                    <div style="display: flex; align-items: center; margin-bottom: 8px;">
                                        <div style="width: 12px; height: 12px; border-radius: 50%; background: #52c41a; margin-right: 8px;"></div>
                                        <span style="font-weight: 500; flex: 1;">ç»¼åˆç§‘ç›®</span>
                                    </div>
                                    <div style="display: flex; align-items: center;">
                                        <input type="range" id="otherCoeff" min="1" max="10" value="7" step="1" style="flex: 1;" oninput="updateCoefficients()">
                                        <input type="number" id="otherCoeffInput" min="1" max="10" value="7" style="width: 50px; margin-left: 10px;" onchange="updateCoefficients()">
                                    </div>
                                </div>
                                
                                <div style="background: #fffaf0; padding: 12px; border-radius: 6px;">
                                    <div style="display: flex; align-items: center; margin-bottom: 8px;">
                                        <div style="width: 12px; height: 12px; border-radius: 50%; background: #faad14; margin-right: 8px;"></div>
                                        <span style="font-weight: 500; flex: 1;">è¿åŠ¨è§£å‹</span>
                                    </div>
                                    <div style="display: flex; align-items: center;">
                                        <input type="range" id="exerciseCoeff" min="1" max="10" value="6" step="1" style="flex: 1;" oninput="updateCoefficients()">
                                        <input type="number" id="exerciseCoeffInput" min="1" max="10" value="6" style="width: 50px; margin-left: 10px;" onchange="updateCoefficients()">
                                    </div>
                                </div>
                                
                                <div style="background: #fff0f0; padding: 12px; border-radius: 6px;">
                                    <div style="display: flex; align-items: center; margin-bottom: 8px;">
                                        <div style="width: 12px; height: 12px; border-radius: 50%; background: #ff4d4f; margin-right: 8px;"></div>
                                        <span style="font-weight: 500; flex: 1;">å……ç”µæ”¾æ¾</span>
                                    </div>
                                    <div style="display: flex; align-items: center;">
                                        <input type="range" id="relaxCoeff" min="1" max="10" value="5" step="1" style="flex: 1;" oninput="updateCoefficients()">
                                        <input type="number" id="relaxCoeffInput" min="1" max="10" value="5" style="width: 50px; margin-left: 10px;" onchange="updateCoefficients()">
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-title">ğŸ§® ç›®æ ‡å‡½æ•°è®¡ç®—</div>
                            <p>æ ¹æ®æ‰€è®¾å®šçš„ç³»æ•°ï¼Œç›®æ ‡å‡½æ•°å°†è¢«è¡¨ç¤ºä¸ºï¼š</p>
                            
                            <div style="background: #f9f9f9; padding: 12px; border-radius: 6px; margin-top: 10px; font-family: 'Courier New', monospace; text-align: center;">
                                <span style="font-size: 16px;" id="objective-function">
                                    æœ€å¤§åŒ– Z = ${mainCoeff}x + ${otherCoeff}y + ${exerciseCoeff}(0.5) + ${relaxCoeff}(0.5) = ${mainCoeff}x + ${otherCoeff}y + ${fixedValue}`;
                                </span>
                            </div>
                            
                            <div style="margin-top: 15px; font-size: 14px; color: #666;">
                                <p><b>ç³»æ•°å«ä¹‰</b>ï¼šç³»æ•°è¶Šé«˜ï¼Œè¡¨ç¤ºè¯¥æ´»åŠ¨è¶Šé‡è¦æˆ–ä»·å€¼è¶Šå¤§</p>
                                <p><b>æç¤º</b>ï¼šæ ¹æ®ä½ å½“å‰çš„å­¦ä¹ çŠ¶æ€å’Œç›®æ ‡ï¼Œè°ƒæ•´ä¸åŒæ´»åŠ¨çš„ç³»æ•°</p>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-title">ğŸ“Š æ•ˆèƒ½åˆ†æ</div>
                            <p>å„æ´»åŠ¨æ¯å°æ—¶äº§ç”Ÿçš„æ•ˆç›Šå¯¹æ¯”ï¼š</p>
                            
                            <div style="display: flex; align-items: flex-end; height: 150px; gap: 15px; margin-top: 15px; padding: 0 20px;">
                                <div style="display: flex; flex-direction: column; align-items: center; flex: 1;">
                                    <div style="background: #1890ff; width: 40px; border-radius: 4px 4px 0 0;" id="main-bar">
                                        <div style="height: 90px;"></div>
                                    </div>
                                    <div style="margin-top: 8px; font-size: 12px; text-align: center;">ä¸»ç§‘å†²åˆº</div>
                                    <div style="font-weight: 500; font-size: 14px;" id="main-value">9åˆ†/å°æ—¶</div>
                                </div>
                                
                                <div style="display: flex; flex-direction: column; align-items: center; flex: 1;">
                                    <div style="background: #52c41a; width: 40px; border-radius: 4px 4px 0 0;" id="other-bar">
                                        <div style="height: 70px;"></div>
                                    </div>
                                    <div style="margin-top: 8px; font-size: 12px; text-align: center;">ç»¼åˆç§‘ç›®</div>
                                    <div style="font-weight: 500; font-size: 14px;" id="other-value">7åˆ†/å°æ—¶</div>
                                </div>
                                
                                <div style="display: flex; flex-direction: column; align-items: center; flex: 1;">
                                    <div style="background: #faad14; width: 40px; border-radius: 4px 4px 0 0;" id="exercise-bar">
                                        <div style="height: 60px;"></div>
                                    </div>
                                    <div style="margin-top: 8px; font-size: 12px; text-align: center;">è¿åŠ¨è§£å‹</div>
                                    <div style="font-weight: 500; font-size: 14px;" id="exercise-value">6åˆ†/å°æ—¶</div>
                                </div>
                                
                                <div style="display: flex; flex-direction: column; align-items: center; flex: 1;">
                                    <div style="background: #ff4d4f; width: 40px; border-radius: 4px 4px 0 0;" id="relax-bar">
                                        <div style="height: 50px;"></div>
                                    </div>
                                    <div style="margin-top: 8px; font-size: 12px; text-align: center;">å……ç”µæ”¾æ¾</div>
                                    <div style="font-weight: 500; font-size: 14px;" id="relax-value">5åˆ†/å°æ—¶</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- å›¾è¡¨å®¹å™¨ -->
                        <div class="chart-container">
                            <div id="chart"></div>
                            <div class="loading-overlay" id="loading-overlay">
                                <div class="loading-spinner"></div>
                            </div>
                        </div>
                        
                        <!-- å¯¼èˆªæŒ‰é’® -->
                        <div class="btn-row">
                            <button class="btn btn-secondary" onclick="prevStep()">ä¸Šä¸€æ­¥</button>
                            <button class="btn btn-primary" onclick="nextStep()">ä¸‹ä¸€æ­¥</button>
                        </div>
                    </div>
                </div>
                
                <!-- æ­¥éª¤3ï¼šæ¢ç´¢å¯è¡ŒåŸŸ -->
                <div class="step-content" id="step-content-3">
                    <div class="panel-header">
                        <h2>æ­¥éª¤3ï¼šæ¢ç´¢å¯è¡ŒåŸŸ</h2>
                        <p>æŸ¥çœ‹æ‰€æœ‰æ»¡è¶³çº¦æŸæ¡ä»¶çš„å¯èƒ½æ—¶é—´åˆ†é…æ–¹æ¡ˆ</p>
                    </div>
                    
                    <div class="panel-body">
                        <div class="card active">
                            <div class="card-title">ğŸ§­ å¯è¡ŒåŸŸæ¢ç´¢</div>
                            <p>å¯è¡ŒåŸŸæ˜¯æ»¡è¶³æ‰€æœ‰çº¦æŸæ¡ä»¶çš„åŒºåŸŸï¼ˆç»¿è‰²åŒºåŸŸï¼‰ã€‚é¡¶ç‚¹æ˜¯æ‰¾å‡ºæœ€ä¼˜è§£çš„å…³é”®ç‚¹ã€‚</p>
                            
                            <div style="margin-top: 15px; display: flex; gap: 10px;">
                                <button class="btn btn-primary" id="vertexBtn" onclick="toggleVertex()">
                                    <span id="vertex-btn-text">æ˜¾ç¤ºé¡¶ç‚¹åæ ‡</span>
                                </button>
                                <button class="btn btn-secondary" onclick="autoZoom()">
                                    æ™ºèƒ½ç¼©æ”¾è§†å›¾
                                </button>
                                <button class="btn btn-secondary" onclick="resetZoom()">
                                    é‡ç½®è§†å›¾
                                </button>
                            </div>
                        </div>
                        
                        <div class="card" id="feasible-region-card">
                            <div class="card-title">ğŸ“ å¯è¡ŒåŸŸåˆ†æ</div>
                            <p>æ ¹æ®ä½ è®¾ç½®çš„çº¦æŸæ¡ä»¶ï¼Œå½“å‰å›¾ä¸­çš„ç»¿è‰²åŒºåŸŸæ˜¯æ‰€æœ‰å¯èƒ½çš„æ—¶é—´åˆ†é…æ–¹æ¡ˆï¼š</p>
                            
                            <div style="background: #f5f5f5; border-radius: 6px; padding: 15px; margin-top: 15px;">
                                <div id="no-vertices-message" style="display: none; color: #ff4d4f; text-align: center; padding: 10px;">
                                    <svg viewBox="64 64 896 896" focusable="false" data-icon="warning" width="16px" height="16px" fill="currentColor" aria-hidden="true"><path d="M464 720a48 48 0 1096 0 48 48 0 10-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8zm475.7 440l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z"></path></svg>
                                    <span style="margin-left: 8px; vertical-align: middle;">å½“å‰çº¦æŸæ¡ä»¶ä¸‹æ²¡æœ‰å¯è¡Œè§£ï¼Œè¯·è°ƒæ•´çº¦æŸæ¡ä»¶</span>
                                </div>
                                
                                <div id="vertices-list" style="display: none;">
                                    <p style="font-weight: 500; margin-bottom: 10px;">å¯è¡ŒåŸŸé¡¶ç‚¹åæ ‡ï¼š</p>
                                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 10px;" id="vertices-grid">
                                        <!-- é¡¶ç‚¹å°†åœ¨JavaScriptä¸­åŠ¨æ€æ·»åŠ  -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-title">ğŸ”‘ å…³é”®æ¦‚å¿µ</div>
                            <p>çº¿æ€§è§„åˆ’çš„å…³é”®åŸç†æ˜¯ï¼š<b>æœ€ä¼˜è§£æ€»æ˜¯å‡ºç°åœ¨å¯è¡ŒåŸŸçš„é¡¶ç‚¹ä¸Š</b>ã€‚</p>
                            
                            <div style="display: flex; gap: 15px; margin-top: 15px;">
                                <div style="flex: 1; padding: 12px; background: #f0f5ff; border-radius: 6px;">
                                    <div style="font-weight: 500; margin-bottom: 5px; color: #1890ff;">çº¦æŸçº¿</div>
                                    <p style="font-size: 13px; margin: 0;">çº¦æŸæ¡ä»¶åœ¨åæ ‡ç³»ä¸­è¡¨ç¤ºä¸ºç›´çº¿ï¼Œè¿™äº›ç›´çº¿çš„äº¤ç‚¹å½¢æˆå¯è¡ŒåŸŸçš„é¡¶ç‚¹</p>
                                </div>
                                <div style="flex: 1; padding: 12px; background: #f0f5ff; border-radius: 6px;">
                                    <div style="font-weight: 500; margin-bottom: 5px; color: #1890ff;">å¯è¡Œè§£</div>
                                    <p style="font-size: 13px; margin: 0;">å¯è¡ŒåŸŸå†…çš„ä»»æ„ç‚¹éƒ½æ˜¯æ»¡è¶³çº¦æŸæ¡ä»¶çš„å¯è¡Œè§£ï¼Œä½†æœ€ä¼˜è§£åœ¨é¡¶ç‚¹</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- å›¾è¡¨å®¹å™¨ -->
                        <div class="chart-container">
                            <div id="chart"></div>
                            <div class="loading-overlay" id="loading-overlay">
                                <div class="loading-spinner"></div>
                            </div>
                        </div>
                        
                        <!-- å¯¼èˆªæŒ‰é’® -->
                        <div class="btn-row">
                            <button class="btn btn-secondary" onclick="prevStep()">ä¸Šä¸€æ­¥</button>
                            <button class="btn btn-primary" onclick="nextStep()">ä¸‹ä¸€æ­¥</button>
                        </div>
                    </div>
                </div>
                
                <!-- æ­¥éª¤4ï¼šå¯»æ‰¾æœ€ä¼˜è§£ -->
                <div class="step-content" id="step-content-4">
                    <div class="panel-header">
                        <h2>æ­¥éª¤4ï¼šå¯»æ‰¾æœ€ä¼˜è§£</h2>
                        <p>ç¡®å®šæœ€ä¼˜æ—¶é—´åˆ†é…æ–¹æ¡ˆ</p>
                    </div>
                    
                    <div class="panel-body">
                        <div class="card active">
                            <div class="card-title">ğŸ¯ æœ€ä¼˜è§£åˆ†æ</div>
                            <p>æ ¹æ®ç›®æ ‡å‡½æ•°ï¼šZ = <span id="optimal-function-text">9x + 7y + 5.5</span>ï¼Œåœ¨çº¦æŸæ¡ä»¶ä¸‹çš„æœ€ä¼˜è§£ä¸ºï¼š</p>
                            
                            <div id="optimal-solution-card" style="background: #f6ffed; border: 1px solid #b7eb8f; border-radius: 6px; padding: 15px; margin-top: 15px; display: none;">
                                <div style="display: flex; align-items: flex-start;">
                                    <div style="background: #52c41a; color: white; padding: 8px; border-radius: 50%; margin-right: 12px; display: flex; align-items: center; justify-content: center; width: 24px; height: 24px;">
                                        <svg viewBox="64 64 896 896" focusable="false" data-icon="check" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M912 190h-69.9c-9.8 0-19.1 4.5-25.1 12.2L404.7 724.5 207 474a32 32 0 00-25.1-12.2H112c-6.7 0-10.4 7.7-6.3 12.9l273.9 347c12.8 16.2 37.4 16.2 50.3 0l488.4-618.9c4.1-5.1.4-12.8-6.3-12.8z"></path></svg>
                                    </div>
                                    <div style="flex: 1;">
                                        <div style="font-weight: 600; margin-bottom: 8px; color: #333; font-size: 16px;">æœ€ä¼˜è§£åæ ‡</div>
                                        <div style="display: flex; margin-bottom: 8px;">
                                            <div style="flex: 1; padding-right: 10px;">
                                                <div style="font-size: 13px; color: #666; margin-bottom: 3px;">ä¸»ç§‘æ—¶é—´ (x):</div>
                                                <div style="font-weight: 500; color: #1890ff; font-size: 16px;" id="optimal-x">0.0</div>
                                            </div>
                                            <div style="flex: 1; padding-right: 10px;">
                                                <div style="font-size: 13px; color: #666; margin-bottom: 3px;">ç»¼åˆç§‘ç›® (y):</div>
                                                <div style="font-weight: 500; color: #52c41a; font-size: 16px;" id="optimal-y">0.0</div>
                                            </div>
                                            <div style="flex: 1;">
                                                <div style="font-size: 13px; color: #666; margin-bottom: 3px;">æ€»æ•ˆç›Šå€¼:</div>
                                                <div style="font-weight: 500; color: #722ed1; font-size: 16px;" id="optimal-value">0.0</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div id="no-solution-message" style="display: none; background: #fff2f0; border: 1px solid #ffccc7; border-radius: 6px; padding: 15px; margin-top: 15px;">
                                <div style="display: flex; align-items: flex-start;">
                                    <div style="background: #ff4d4f; color: white; padding: 8px; border-radius: 50%; margin-right: 12px; display: flex; align-items: center; justify-content: center; width: 24px; height: 24px;">
                                        <svg viewBox="64 64 896 896" focusable="false" data-icon="close" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M563.8 512l262.5-312.9c4.4-5.2.7-13.1-6.1-13.1h-79.8c-4.7 0-9.2 2.1-12.3 5.7L511.6 449.8 295.1 191.7c-3-3.6-7.5-5.7-12.3-5.7H203c-6.8 0-10.5 7.9-6.1 13.1L459.4 512 196.9 824.9A7.95 7.95 0 00203 838h79.8c4.7 0 9.2-2.1 12.3-5.7l216.5-258.1 216.5 258.1c3 3.6 7.5 5.7 12.3 5.7h79.8c6.8 0 10.5-7.9 6.1-13.1L563.8 512z"></path></svg>
                                    </div>
                                    <div>
                                        <div style="font-weight: 600; margin-bottom: 8px; color: #333; font-size: 16px;">æ— å¯è¡Œè§£</div>
                                        <div style="font-size: 14px; color: #666; line-height: 1.5;">
                                            å½“å‰çº¦æŸæ¡ä»¶ä¸‹æ²¡æœ‰å¯è¡Œçš„è§£ï¼Œè¯·è°ƒæ•´çº¦æŸæ¡ä»¶ã€‚å¸¸è§åŸå› æ˜¯ä¸»ç§‘å’Œç»¼åˆç§‘ç›®çš„æœ€ä½æ—¶é—´è¦æ±‚æ€»å’Œè¶…è¿‡äº†æœ€å¤§å¯ç”¨æ—¶é—´ã€‚
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card" id="time-allocation-card" style="display: none;">
                            <div class="card-title">â±ï¸ æœ€ä¼˜æ—¶é—´åˆ†é…</div>
                            <p>æ ¹æ®æœ€ä¼˜è§£ï¼Œæœ€ä½³çš„æ—¶é—´åˆ†é…æ–¹æ¡ˆå¦‚ä¸‹ï¼ˆæ€»æ—¶é—´ï¼š<span id="total-time-value">4.0</span>å°æ—¶ï¼‰ï¼š</p>
                            
                            <div class="time-bar-container">
                                <div class="time-bar">
                                    <div class="time-segment segment-main"></div>
                                    <div class="time-segment segment-other"></div>
                                    <div class="time-segment segment-exercise"></div>
                                    <div class="time-segment segment-relax"></div>
                                </div>
                                <div class="time-scale">
                                    <span>0h</span>
                                    <span>1h</span>
                                    <span>2h</span>
                                    <span>3h</span>
                                    <span>4h</span>
                                </div>
                            </div>
                            
                            <div style="display: flex; margin-top: 20px; gap: 15px;">
                                <div style="flex: 1; background: #f0f7ff; padding: 12px; border-radius: 6px;">
                                    <div style="display: flex; align-items: center; margin-bottom: 8px;">
                                        <div style="width: 12px; height: 12px; border-radius: 50%; background: #1890ff; margin-right: 8px;"></div>
                                        <span style="font-weight: 500; flex: 1;">ä¸»ç§‘å†²åˆº</span>
                                    </div>
                                    <div style="font-weight: 500; font-size: 14px; color: #1890ff;" id="main-time-value">0.0å°æ—¶</div>
                                </div>
                                
                                <div style="flex: 1; background: #f0fff7; padding: 12px; border-radius: 6px;">
                                    <div style="display: flex; align-items: center; margin-bottom: 8px;">
                                        <div style="width: 12px; height: 12px; border-radius: 50%; background: #52c41a; margin-right: 8px;"></div>
                                        <span style="font-weight: 500; flex: 1;">ç»¼åˆç§‘ç›®</span>
                                    </div>
                                    <div style="font-weight: 500; font-size: 14px; color: #52c41a;" id="other-time-value">0.0å°æ—¶</div>
                                </div>
                                
                                <div style="flex: 1; background: #fffaf0; padding: 12px; border-radius: 6px;">
                                    <div style="display: flex; align-items: center; margin-bottom: 8px;">
                                        <div style="width: 12px; height: 12px; border-radius: 50%; background: #faad14; margin-right: 8px;"></div>
                                        <span style="font-weight: 500; flex: 1;">è¿åŠ¨è§£å‹</span>
                                    </div>
                                    <div style="font-weight: 500; font-size: 14px; color: #faad14;">0.5å°æ—¶</div>
                                </div>
                                
                                <div style="flex: 1; background: #fff0f0; padding: 12px; border-radius: 6px;">
                                    <div style="display: flex; align-items: center; margin-bottom: 8px;">
                                        <div style="width: 12px; height: 12px; border-radius: 50%; background: #ff4d4f; margin-right: 8px;"></div>
                                        <span style="font-weight: 500; flex: 1;">å……ç”µæ”¾æ¾</span>
                                    </div>
                                    <div style="font-weight: 500; font-size: 14px; color: #ff4d4f;">0.5å°æ—¶</div>
                                </div>
                            </div>
                            
                            <div style="margin-top: 15px; background: #f9f0ff; padding: 12px; border-radius: 6px;">
                                <div style="display: flex; align-items: center; margin-bottom: 8px;">
                                    <div style="width: 12px; height: 12px; border-radius: 50%; background: #722ed1; margin-right: 8px;"></div>
                                    <span style="font-weight: 500;">æ€»æ•ˆç›Šå€¼</span>
                                </div>
                                <div style="font-weight: 600; font-size: 16px; color: #722ed1;">
                                    <span id="total-value">0.0</span> åˆ†
                                </div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-title">ğŸ” çº¦æŸæ¡ä»¶å›é¡¾</div>
                            <p>è®¡ç®—æœ€ä¼˜è§£æ—¶è€ƒè™‘äº†ä»¥ä¸‹çº¦æŸæ¡ä»¶ï¼š</p>
                            
                            <div style="margin-top: 10px;">
                                <div class="legend-item">
                                    <div class="legend-color" style="background: #ff4d4f;"></div>
                                    <div class="legend-text">æ€»æ—¶é—´çº¦æŸ: x + y + 1 â‰¤ 4ï¼ˆå³x + y â‰¤ 3ï¼‰</div>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background: #1890ff;"></div>
                                    <div class="legend-text">ä¸»ç§‘æ—¶é—´ä¸‹é™: x â‰¥ <span id="main-min-value">1.5</span></div>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background: #52c41a;"></div>
                                    <div class="legend-text">ç»¼åˆç§‘ç›®ä¸‹é™: y â‰¥ <span id="other-min-value">1</span></div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- å›¾è¡¨å®¹å™¨ -->
                        <div class="chart-container">
                            <div id="chart"></div>
                            <div class="loading-overlay" id="loading-overlay">
                                <div class="loading-spinner"></div>
                            </div>
                        </div>
                        
                        <!-- å¯¼èˆªæŒ‰é’® -->
                        <div class="btn-row">
                            <button class="btn btn-secondary" onclick="prevStep()">ä¸Šä¸€æ­¥</button>
                            <button class="btn btn-primary" onclick="nextStep()">ä¸‹ä¸€æ­¥</button>
                        </div>
                    </div>
                </div>
                
                <!-- æ­¥éª¤5ï¼šé«˜çº§æ¢ç´¢ -->
                <div class="step-content" id="step-content-5">
                    <div class="panel-header">
                        <h2>æ­¥éª¤5ï¼šé«˜çº§æ¢ç´¢</h2>
                        <p>çµæ´»è°ƒæ•´å‚æ•°ï¼Œæ·±å…¥ç†è§£çº¿æ€§è§„åˆ’</p>
                    </div>
                    
                    <div class="panel-body">
                        <div class="tabs">
                            <button class="tab-button active" onclick="switchTab('sensitivity')">æ•æ„Ÿæ€§åˆ†æ</button>
                            <button class="tab-button" onclick="switchTab('custom')">è‡ªå®šä¹‰æ¢ç´¢</button>
                            <button class="tab-button" onclick="switchTab('compare')">æ–¹æ¡ˆå¯¹æ¯”</button>
                        </div>
                        
                        <!-- æ•æ„Ÿæ€§åˆ†æ -->
                        <div class="tab-content active" id="tab-sensitivity">
                            <div class="card">
                                <div class="card-title">ğŸ“Š æ•ˆèƒ½ç³»æ•°æ•æ„Ÿæ€§åˆ†æ</div>
                                <p>æ¢ç´¢æ”¹å˜æ•ˆèƒ½ç³»æ•°å¯¹æœ€ä¼˜è§£çš„å½±å“ã€‚æ‹–åŠ¨æ»‘å—è°ƒæ•´ç³»æ•°ï¼ŒæŸ¥çœ‹æœ€ä¼˜è§£çš„å˜åŒ–ï¼š</p>
                                
                                <div style="margin-top: 15px;">
                                    <div style="margin-bottom: 15px;">
                                        <div style="display: flex; align-items: center; margin-bottom: 8px;">
                                            <div style="width: 12px; height: 12px; border-radius: 50%; background: #1890ff; margin-right: 8px;"></div>
                                            <span style="font-weight: 500;">ä¸»ç§‘æ•ˆèƒ½ç³»æ•°</span>
                                            <span style="margin-left: auto; font-weight: 500; color: #1890ff;" id="main-sensitivity-value">9</span>
                                        </div>
                                        <input type="range" min="1" max="20" value="9" step="1" style="width: 100%;" oninput="updateSensitivity('main', this.value)">
                                    </div>
                                    
                                    <div style="margin-bottom: 15px;">
                                        <div style="display: flex; align-items: center; margin-bottom: 8px;">
                                            <div style="width: 12px; height: 12px; border-radius: 50%; background: #52c41a; margin-right: 8px;"></div>
                                            <span style="font-weight: 500;">ç»¼åˆç§‘ç›®æ•ˆèƒ½ç³»æ•°</span>
                                            <span style="margin-left: auto; font-weight: 500; color: #52c41a;" id="other-sensitivity-value">7</span>
                                        </div>
                                        <input type="range" min="1" max="20" value="7" step="1" style="width: 100%;" oninput="updateSensitivity('other', this.value)">
                                    </div>
                                </div>
                                
                                <div style="margin-top: 15px; background: #f0f5ff; border-radius: 6px; padding: 15px;">
                                    <div style="font-weight: 500; margin-bottom: 8px;">æ•æ„Ÿæ€§åˆ†æç»“æœ</div>
                                    <div style="font-size: 14px; color: #666; line-height: 1.5;" id="sensitivity-result">
                                        è°ƒæ•´æ•ˆèƒ½ç³»æ•°æ¥æŸ¥çœ‹æœ€ä¼˜è§£çš„å˜åŒ–...
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card">
                                <div class="card-title">ğŸ§® å‚æ•°ä¸´ç•Œå€¼åˆ†æ</div>
                                <p>æ¢ç´¢æ•ˆèƒ½ç³»æ•°çš„ä¸´ç•Œå€¼ï¼Œåœ¨è¿™äº›å€¼é™„è¿‘æœ€ä¼˜è§£ä¼šå‘ç”Ÿè·³å˜ï¼š</p>
                                
                                <div style="margin-top: 15px; background: #f9f0ff; border-radius: 6px; padding: 15px;">
                                    <div style="font-weight: 500; margin-bottom: 8px;">å‚æ•°ä¸´ç•Œå€¼</div>
                                    <div id="critical-values">
                                        <p>å½“ä¸»ç§‘/ç»¼åˆç§‘ç›®æ•ˆèƒ½ç³»æ•°æ¯”å€¼åœ¨ä¸´ç•Œç‚¹å˜åŒ–æ—¶ï¼Œæœ€ä¼˜è§£ä¼šå‘ç”Ÿå˜åŒ–ã€‚</p>
                                        <ul style="padding-left: 20px; margin-top: 10px;">
                                            <li style="margin-bottom: 5px;">å¦‚æœ ä¸»ç§‘ç³»æ•°/ç»¼åˆç³»æ•° > 1ï¼Œæœ€ä¼˜è§£ä¼˜å…ˆåˆ†é…æ›´å¤šæ—¶é—´ç»™ä¸»ç§‘</li>
                                            <li style="margin-bottom: 5px;">å¦‚æœ ä¸»ç§‘ç³»æ•°/ç»¼åˆç³»æ•° < 1ï¼Œæœ€ä¼˜è§£ä¼˜å…ˆåˆ†é…æ›´å¤šæ—¶é—´ç»™ç»¼åˆç§‘ç›®</li>
                                            <li>å¦‚æœ ä¸»ç§‘ç³»æ•°/ç»¼åˆç³»æ•° = 1ï¼Œåˆ™å¤šä¸ªé¡¶ç‚¹å…·æœ‰ç›¸åŒçš„æœ€ä¼˜å€¼</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- è‡ªå®šä¹‰æ¢ç´¢ -->
                        <div class="tab-content" id="tab-custom">
                            <div class="card">
                                <div class="card-title">ğŸ”„ è°ƒæ•´æ€»æ—¶é—´é™åˆ¶</div>
                                <p>æ¢ç´¢æ”¹å˜æ€»å¯ç”¨æ—¶é—´å¯¹æœ€ä¼˜è§£çš„å½±å“ï¼š</p>
                                
                                <div style="margin-top: 15px;">
                                    <div style="display: flex; align-items: center; margin-bottom: 8px;">
                                        <span style="font-weight: 500;">æ€»å¯ç”¨æ—¶é—´</span>
                                        <span style="margin-left: auto; font-weight: 500; color: #1890ff;" id="total-time-custom-value">4.0</span>
                                        <span style="margin-left: 5px;">å°æ—¶</span>
                                    </div>
                                    <input type="range" min="2" max="8" value="4" step="0.5" style="width: 100%;" oninput="updateTotalTime(this.value)">
                                </div>
                                
                                <div style="margin-top: 15px;">
                                    <button class="btn btn-primary" onclick="updateCustomExploration()">
                                        åº”ç”¨æ›´æ”¹
                                    </button>
                                    <button class="btn btn-secondary" style="margin-left: 10px;" onclick="resetCustomExploration()">
                                        é‡ç½®é»˜è®¤å€¼
                                    </button>
                                </div>
                            </div>
                            
                            <div class="card">
                                <div class="card-title">ğŸ“ è°ƒæ•´çº¦æŸä¸‹é™</div>
                                <p>æ¢ç´¢æ”¹å˜æœ€ä½å­¦ä¹ æ—¶é—´è¦æ±‚å¯¹æœ€ä¼˜è§£çš„å½±å“ï¼š</p>
                                
                                <div style="margin-top: 15px;">
                                    <div class="input-row">
                                        <div class="input-label">ä¸»ç§‘ä¸‹é™:</div>
                                        <div class="input-control">
                                            <input type="range" id="mainSubjectCustom" min="0" max="3" value="1.5" step="0.1" oninput="updateMainSubjectCustom(this.value)">
                                            <input type="number" id="mainSubjectCustomInput" min="0" max="3" value="1.5" step="0.1" style="width: 60px;" onchange="updateMainSubjectCustom(this.value)">
                                            <span style="margin-left: 5px;">å°æ—¶</span>
                                        </div>
                                    </div>
                                    
                                    <div class="input-row">
                                        <div class="input-label">ç»¼åˆä¸‹é™:</div>
                                        <div class="input-control">
                                            <input type="range" id="otherSubjectCustom" min="0" max="3" value="1" step="0.1" oninput="updateOtherSubjectCustom(this.value)">
                                            <input type="number" id="otherSubjectCustomInput" min="0" max="3" value="1" step="0.1" style="width: 60px;" onchange="updateOtherSubjectCustom(this.value)">
                                            <span style="margin-left: 5px;">å°æ—¶</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div style="margin-top: 15px;">
                                    <button class="btn btn-primary" onclick="updateCustomExploration()">
                                        åº”ç”¨æ›´æ”¹
                                    </button>
                                </div>
                            </div>
                            
                            <div class="card">
                                <div class="card-title">ğŸ’¡ æ¢ç´¢å‘ç°</div>
                                <div style="margin-top: 15px; background: #f0f5ff; border-radius: 6px; padding: 15px;">
                                    <div id="custom-exploration-result">
                                        <p>çº¿æ€§è§„åˆ’çš„å…³é”®å‘ç°ï¼š</p>
                                        <ul style="padding-left: 20px; margin-top: 10px;">
                                            <li>å¢åŠ æ€»æ—¶é—´é€šå¸¸ä¼šæé«˜æ€»æ•ˆç›Šï¼Œä½†æœ€ä¼˜åˆ†é…æ¯”ä¾‹å¯èƒ½ä¿æŒä¸å˜</li>
                                            <li>å¦‚æœæŸä¸ªçº¦æŸæ¡ä»¶ä¸å†èµ·ä½œç”¨ï¼ˆéç´§çº¦æŸï¼‰ï¼Œæœ€ä¼˜è§£å¯èƒ½ä¸ä¼šæ”¹å˜</li>
                                            <li>å½“ä¸€ä¸ªçº¦æŸå˜å¾—æ›´ä¸¥æ ¼æ—¶ï¼Œæ€»æ•ˆç›Šé€šå¸¸ä¼šé™ä½</li>
                                            <li>æœ€ä¼˜è§£æ€»æ˜¯å‡ºç°åœ¨å¯è¡ŒåŸŸçš„é¡¶ç‚¹ä¸Š</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- æ–¹æ¡ˆå¯¹æ¯” -->
                        <div class="tab-content" id="tab-compare">
                            <div class="card">
                                <div class="card-title">ğŸ”„ æ–¹æ¡ˆå¯¹æ¯”åˆ†æ</div>
                                <p>æ¯”è¾ƒä¸åŒæ—¶é—´åˆ†é…æ–¹æ¡ˆçš„æ•ˆç›Šå·®å¼‚ï¼š</p>
                                
                                <div style="margin-top: 15px; display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                                    <div style="background: #f0f5ff; padding: 15px; border-radius: 6px;">
                                        <div style="font-weight: 500; margin-bottom: 10px; display: flex; align-items: center;">
                                            <span style="width: 20px; height: 20px; background: #1890ff; border-radius: 50%; margin-right: 8px;"></span>
                                            æœ€ä¼˜æ–¹æ¡ˆ
                                        </div>
                                        <div style="margin-top: 10px;">
                                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                                <div style="color: #666;">ä¸»ç§‘æ—¶é—´:</div>
                                                <div style="font-weight: 500;" id="optimal-x-compare">0.0å°æ—¶</div>
                                            </div>
                                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                                <div style="color: #666;">ç»¼åˆç§‘ç›®:</div>
                                                <div style="font-weight: 500;" id="optimal-y-compare">0.0å°æ—¶</div>
                                            </div>
                                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                                <div style="color: #666;">å›ºå®šæ´»åŠ¨:</div>
                                                <div style="font-weight: 500;">1.0å°æ—¶</div>
                                            </div>
                                            <div style="display: flex; justify-content: space-between; padding-top: 5px; border-top: 1px dashed #ccc; margin-top: 5px;">
                                                <div style="color: #666;">æ€»æ•ˆç›Šå€¼:</div>
                                                <div style="font-weight: 600; color: #1890ff;" id="optimal-value-compare">0.0</div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div style="background: #f6ffed; padding: 15px; border-radius: 6px;">
                                        <div style="font-weight: 500; margin-bottom: 10px; display: flex; align-items: center;">
                                            <span style="width: 20px; height: 20px; background: #52c41a; border-radius: 50%; margin-right: 8px;"></span>
                                            å¹³å‡æ–¹æ¡ˆ
                                        </div>
                                        <div style="margin-top: 10px;">
                                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                                <div style="color: #666;">ä¸»ç§‘æ—¶é—´:</div>
                                                <div style="font-weight: 500;" id="average-x-compare">1.5å°æ—¶</div>
                                            </div>
                                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                                <div style="color: #666;">ç»¼åˆç§‘ç›®:</div>
                                                <div style="font-weight: 500;" id="average-y-compare">1.5å°æ—¶</div>
                                            </div>
                                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                                <div style="color: #666;">å›ºå®šæ´»åŠ¨:</div>
                                                <div style="font-weight: 500;">1.0å°æ—¶</div>
                                            </div>
                                            <div style="display: flex; justify-content: space-between; padding-top: 5px; border-top: 1px dashed #ccc; margin-top: 5px;">
                                                <div style="color: #666;">æ€»æ•ˆç›Šå€¼:</div>
                                                <div style="font-weight: 600; color: #52c41a;" id="average-value-compare">0.0</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- æ·»åŠ ç»Ÿè®¡å›¾è¡¨å®¹å™¨ -->
                                <div style="margin-top: 20px; background: white; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); padding: 15px;">
                                    <div style="font-weight: 500; margin-bottom: 15px; color: #333; text-align: center;">
                                        æ–¹æ¡ˆæ•ˆç›Šç»Ÿè®¡å›¾è¡¨
                                    </div>
                                    <div id="statistics-chart" style="width: 100%; height: 250px;"></div>
                                </div>
                                
                                <div style="margin-top: 15px; background: #f9f0ff; border-radius: 6px; padding: 15px;">
                                    <div style="font-weight: 500; margin-bottom: 8px;">æ•ˆç›Šå·®å¼‚åˆ†æ</div>
                                    <div id="compare-result" style="font-size: 14px; color: #666; line-height: 1.5;">
                                        é€šè¿‡çº¿æ€§è§„åˆ’æ‰¾åˆ°çš„æœ€ä¼˜è§£æ¯”å¹³å‡åˆ†é…æ–¹æ¡ˆå¯ä»¥æé«˜ <span id="improvement-percentage" style="color: #722ed1; font-weight: 600;">0%</span> çš„æ€»æ•ˆç›Šå€¼ã€‚è¿™è¯´æ˜äº†æ•°å­¦æ–¹æ³•åœ¨èµ„æºä¼˜åŒ–é…ç½®ä¸­çš„é‡è¦æ€§ã€‚
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card">
                                <div class="card-title">ğŸ’¡ æ€è€ƒä¸å¯ç¤º</div>
                                <div style="margin-top: 15px; background: #f0f5ff; border-radius: 6px; padding: 15px;">
                                    <div id="comparison-insights">
                                        <p>ä»æ—¶é—´ç®¡ç†æœ€ä¼˜åŒ–ä¸­å¯ä»¥è·å¾—çš„å¯ç¤ºï¼š</p>
                                        <ul style="padding-left: 20px; margin-top: 10px;">
                                            <li>ç§‘å­¦çš„æ—¶é—´ç®¡ç†å¯ä»¥æ˜¾è‘—æå‡å­¦ä¹ æ•ˆç‡</li>
                                            <li>åº”æ ¹æ®ä¸ªäººèƒ½åŠ›å’Œç§‘ç›®é‡è¦æ€§è®¾ç½®åˆç†çš„æ•ˆèƒ½ç³»æ•°</li>
                                            <li>å›ºå®šçš„ä¼‘æ¯å’Œè¿åŠ¨æ—¶é—´å¯¹æ•´ä½“æ•ˆç›Šæœ‰ç§¯æå½±å“</li>
                                            <li>æœ€ä¼˜è§£å‘Šè¯‰æˆ‘ä»¬è¦é‡ç‚¹æŠ•å…¥åˆ°æ•ˆç›Šç³»æ•°é«˜çš„æ´»åŠ¨ä¸Š</li>
                                            <li>æ•°å­¦æ–¹æ³•èƒ½å¸®åŠ©æˆ‘ä»¬åšå‡ºæ›´æ˜æ™ºçš„å†³ç­–</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- å›¾è¡¨å®¹å™¨ -->
                        <div class="chart-container">
                            <div id="chart"></div>
                            <div class="loading-overlay" id="loading-overlay">
                                <div class="loading-spinner"></div>
                            </div>
                        </div>
                        
                        <!-- å¯¼èˆªæŒ‰é’® -->
                        <div class="btn-row">
                            <button class="btn btn-secondary" onclick="prevStep()">ä¸Šä¸€æ­¥</button>
                            <button class="btn btn-success">å®Œæˆå­¦ä¹ </button>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <!-- JavaScript ä»£ç  -->
    <script>
        // å…¨å±€å˜é‡
        let myChart = null;
        let animationTimer = null;
        let animationSteps = [];
        let currentStep = 0;
        let showVertices = false;
        let currentActiveStep = 1;
        let customZoom = false;
        let zoomFactor = { x: 1.3, y: 1.3 };
        let totalTime = 4; // é»˜è®¤æ€»æ—¶é—´ä¸º4å°æ—¶
        
        // æ´»åŠ¨ç³»æ•°
        let coefficients = {
            main: 9,     // ä¸»ç§‘å†²åˆº
            other: 7,    // ç»¼åˆç§‘ç›®
            exercise: 6, // è¿åŠ¨è§£å‹
            relax: 5     // å……ç”µæ”¾æ¾
        };
        
        // å›ºå®šæ—¶é—´æ´»åŠ¨
        const fixedActivities = {
            exercise: 0.5, // è¿åŠ¨è§£å‹
            relax: 0.5     // å……ç”µæ”¾æ¾
        };
        
        // ============== å®‰å…¨åˆå§‹åŒ–å›¾è¡¨ ==============
        function initChart() {
            try {
                // æ£€æŸ¥chartå…ƒç´ æ˜¯å¦å­˜åœ¨
                const chartElement = document.getElementById('chart');
                if (!chartElement) {
                    console.error("æ— æ³•æ‰¾åˆ°IDä¸º'chart'çš„DOMå…ƒç´ ");
                    return false;
                }
                
                // å¦‚æœå·²å­˜åœ¨å›¾è¡¨å®ä¾‹ï¼Œå…ˆé”€æ¯
                if (myChart && myChart.dispose) {
                    myChart.dispose();
                    myChart = null;
                }
                
                // æ£€æŸ¥EChartsåº“æ˜¯å¦æ­£ç¡®åŠ è½½
                if (typeof echarts === 'undefined') {
                    console.error("EChartsåº“æœªåŠ è½½ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–è„šæœ¬å¼•ç”¨");
                    return false;
                }
                
                // åˆ›å»ºæ–°å›¾è¡¨å®ä¾‹
                myChart = echarts.init(chartElement);
                
                // æµ‹è¯•å›¾è¡¨æ˜¯å¦æ­£ç¡®åˆå§‹åŒ–
                if (!myChart || !myChart.setOption) {
                    console.error("å›¾è¡¨åˆå§‹åŒ–å¤±è´¥ï¼Œecharts.initè¿”å›çš„å¯¹è±¡æ— æ•ˆ");
                    return false;
                }
                
                // è®¾ç½®ä¸€ä¸ªç®€å•çš„æµ‹è¯•å›¾è¡¨ï¼Œç¡®ä¿å›¾è¡¨å¯ä»¥æ­£å¸¸å·¥ä½œ
                try {
                    myChart.setOption({
                        xAxis: { type: 'value', min: 0, max: 1 },
                        yAxis: { type: 'value', min: 0, max: 1 },
                        series: [{ type: 'scatter', data: [[0.5, 0.5]] }]
                    });
                } catch (e) {
                    console.error("æµ‹è¯•å›¾è¡¨è®¾ç½®å¤±è´¥:", e);
                    return false;
                }
                
                // æ³¨å†Œçª—å£å¤§å°æ”¹å˜äº‹ä»¶
                window.addEventListener('resize', function() {
                    if (myChart) {
                        try {
                            myChart.resize();
                        } catch (e) {
                            console.error("å›¾è¡¨å¤§å°è°ƒæ•´å¤±è´¥:", e);
                        }
                    }
                });
                
                return true;
            } catch (e) {
                console.error("å›¾è¡¨åˆå§‹åŒ–è¿‡ç¨‹å‘ç”Ÿé”™è¯¯:", e);
                return false;
            }
        }
        
        // ============== æ›´æ–°UI ==============
        function updateUI() {
            document.getElementById('loading-overlay').style.display = 'flex';
            
            // å»¶è¿Ÿæ‰§è¡Œä»¥ç¡®ä¿UIæ›´æ–°
            setTimeout(() => {
                try {
                    // åŒæ­¥è¾“å…¥æ¡†å’Œæ»‘å—å€¼
                    syncInputValues();
                    
                    // æ›´æ–°å›¾è¡¨
                    try {
                        renderChart();
                    } catch (e) {
                        console.error("æ¸²æŸ“å›¾è¡¨é”™è¯¯:", e);
                    }
                    
                    // æ›´æ–°å…¬å¼æ˜¾ç¤º
                    if (document.getElementById('objective-function')) {
                        updateObjectiveFunction();
                    }
                    
                    // å¦‚æœå½“å‰åœ¨æ­¥éª¤3å¹¶ä¸”æ˜¾ç¤ºé¡¶ç‚¹ï¼Œåˆ™æ›´æ–°é¡¶ç‚¹åˆ—è¡¨
                    if (currentActiveStep === 3 && showVertices && document.getElementById('vertices-list')) {
                        updateVerticesList();
                    }
                    
                    // å¦‚æœå½“å‰åœ¨æ­¥éª¤4ï¼Œåˆ™æ›´æ–°æœ€ä¼˜è§£æ˜¾ç¤º
                    if (currentActiveStep === 4) {
                        try {
                            updateOptimalSolutionDisplay();
                        } catch (e) {
                            console.error("æ›´æ–°æœ€ä¼˜è§£æ˜¾ç¤ºé”™è¯¯:", e);
                        }
                    }
                    
                    // å¦‚æœå½“å‰åœ¨æ­¥éª¤5ï¼Œåˆ™æ›´æ–°å„ç§é«˜çº§æ¢ç´¢æ•°æ®
                    if (currentActiveStep === 5) {
                        try {
                            // å®Œå…¨ç¦æ­¢è‡ªåŠ¨è°ƒç”¨ updateComparisonData
                            // åªåœ¨ç”¨æˆ·ä¸»åŠ¨åˆ‡æ¢åˆ°æ¯”è¾ƒæ ‡ç­¾é¡µæ—¶æ‰ä¼šè°ƒç”¨
                            if (document.getElementById('main-sensitivity-value')) {
                                updateSensitivity('main', document.getElementById('main-sensitivity-value').textContent);
                            }
                        } catch (e) {
                            console.error("æ›´æ–°æ•æ„Ÿæ€§åˆ†æé”™è¯¯:", e);
                        }
                    }
                } catch (e) {
                    console.error("æ›´æ–°UIé”™è¯¯:", e);
                } finally {
                    document.getElementById('loading-overlay').style.display = 'none';
                }
            }, 50);
        }
        
        // ============== æ›´æ–°å…¬å¼æ˜¾ç¤º ==============
        function updateObjectiveFunction() {
            const mainCoeff = coefficients.main;
            const otherCoeff = coefficients.other;
            const exerciseCoeff = coefficients.exercise;
            const relaxCoeff = coefficients.relax;
            
            const fixedValue = exerciseCoeff * fixedActivities.exercise + relaxCoeff * fixedActivities.relax;
            
            document.getElementById('objective-function').textContent = 
                `æœ€å¤§åŒ– Z = ${mainCoeff}x + ${otherCoeff}y + ${exerciseCoeff}(0.5) + ${relaxCoeff}(0.5) = ${mainCoeff}x + ${otherCoeff}y + ${fixedValue}`;
        }
        
        // ============== æ›´æ–°æ•ˆèƒ½ç³»æ•°æŸ±çŠ¶å›¾ ==============
        function updateEfficiencyBars() {
            // è·å–æœ€å¤§å€¼æ¥æ ‡å‡†åŒ–é«˜åº¦
            const maxCoeff = Math.max(
                coefficients.main,
                coefficients.other,
                coefficients.exercise,
                coefficients.relax
            );
            
            // è®¾ç½®æŸ±çŠ¶å›¾é«˜åº¦
            document.querySelector('#main-bar div').style.height = `${(coefficients.main / maxCoeff) * 100}px`;
            document.querySelector('#other-bar div').style.height = `${(coefficients.other / maxCoeff) * 100}px`;
            document.querySelector('#exercise-bar div').style.height = `${(coefficients.exercise / maxCoeff) * 100}px`;
            document.querySelector('#relax-bar div').style.height = `${(coefficients.relax / maxCoeff) * 100}px`;
            
            // æ›´æ–°åˆ†å€¼æ–‡æœ¬
            document.getElementById('main-value').textContent = `${coefficients.main}åˆ†/å°æ—¶`;
            document.getElementById('other-value').textContent = `${coefficients.other}åˆ†/å°æ—¶`;
            document.getElementById('exercise-value').textContent = `${coefficients.exercise}åˆ†/å°æ—¶`;
            document.getElementById('relax-value').textContent = `${coefficients.relax}åˆ†/å°æ—¶`;
        }
        
        // ============== åŒæ­¥è¾“å…¥å€¼ ==============
        function syncInputValues() {
            // åŒæ­¥çº¦æŸå€¼
            const mainSubjectInput = document.getElementById('mainSubjectInput');
            const otherSubjectInput = document.getElementById('otherSubjectInput');
            if (mainSubjectInput && document.getElementById('mainSubject')) {
                mainSubjectInput.value = document.getElementById('mainSubject').value;
            }
            if (otherSubjectInput && document.getElementById('otherSubject')) {
                otherSubjectInput.value = document.getElementById('otherSubject').value;
            }
            
            // åŒæ­¥ç³»æ•°å€¼
            if (document.getElementById('mainCoeffInput') && document.getElementById('mainCoeff')) {
                document.getElementById('mainCoeffInput').value = document.getElementById('mainCoeff').value;
            }
            if (document.getElementById('otherCoeffInput') && document.getElementById('otherCoeff')) {
                document.getElementById('otherCoeffInput').value = document.getElementById('otherCoeff').value;
            }
            if (document.getElementById('exerciseCoeffInput') && document.getElementById('exerciseCoeff')) {
                document.getElementById('exerciseCoeffInput').value = document.getElementById('exerciseCoeff').value;
            }
            if (document.getElementById('relaxCoeffInput') && document.getElementById('relaxCoeff')) {
                document.getElementById('relaxCoeffInput').value = document.getElementById('relaxCoeff').value;
            }
        }
        
        // ============== æ›´æ–°ä¸»ç§‘æœ€ä½æ—¶é—´ ==============
        function updateMainSubject(value) {
            const mainSubject = parseFloat(value);
            
            // æ›´æ–°UIå…ƒç´ 
            if (document.getElementById('mainSubject')) {
                document.getElementById('mainSubject').value = mainSubject;
            }
            if (document.getElementById('mainSubjectInput')) {
                document.getElementById('mainSubjectInput').value = mainSubject;
            }
            
            // æ›´æ–°æœ€ä½å€¼æ˜¾ç¤º
            updateMainMinValue(mainSubject);
            
            // æ›´æ–°UI
            updateUI();
        }
        
        // ============== æ›´æ–°ç»¼åˆç§‘ç›®æœ€ä½æ—¶é—´ ==============
        function updateOtherSubject(value) {
            const otherSubject = parseFloat(value);
            
            // æ›´æ–°UIå…ƒç´ 
            if (document.getElementById('otherSubject')) {
                document.getElementById('otherSubject').value = otherSubject;
            }
            if (document.getElementById('otherSubjectInput')) {
                document.getElementById('otherSubjectInput').value = otherSubject;
            }
            
            // æ›´æ–°æœ€ä½å€¼æ˜¾ç¤º
            updateOtherMinValue(otherSubject);
            
            // æ›´æ–°UI
            updateUI();
        }
        
        // ============== æ›´æ–°ä¸»ç§‘æœ€ä½å€¼æ˜¾ç¤º ==============
        function updateMainMinValue(value) {
            const elements = document.querySelectorAll('#main-min-value');
            elements.forEach(el => { el.textContent = value; });
        }
        
        // ============== æ›´æ–°ç»¼åˆç§‘ç›®æœ€ä½å€¼æ˜¾ç¤º ==============
        function updateOtherMinValue(value) {
            const elements = document.querySelectorAll('#other-min-value');
            elements.forEach(el => { el.textContent = value; });
        }
        
        // ============== æ›´æ–°ç³»æ•° ==============
        function updateCoefficients() {
            // ä»è¾“å…¥æ¡†è·å–ç³»æ•°
            if (document.getElementById('mainCoeff')) {
                coefficients.main = parseInt(document.getElementById('mainCoeff').value) || 9;
            } else if (document.getElementById('mainCoeffInput')) {
                coefficients.main = parseInt(document.getElementById('mainCoeffInput').value) || 9;
            }
            
            if (document.getElementById('otherCoeff')) {
                coefficients.other = parseInt(document.getElementById('otherCoeff').value) || 7;
            } else if (document.getElementById('otherCoeffInput')) {
                coefficients.other = parseInt(document.getElementById('otherCoeffInput').value) || 7;
            }
            
            if (document.getElementById('exerciseCoeff')) {
                coefficients.exercise = parseInt(document.getElementById('exerciseCoeff').value) || 6;
            } else if (document.getElementById('exerciseCoeffInput')) {
                coefficients.exercise = parseInt(document.getElementById('exerciseCoeffInput').value) || 6;
            }
            
            if (document.getElementById('relaxCoeff')) {
                coefficients.relax = parseInt(document.getElementById('relaxCoeff').value) || 5;
            } else if (document.getElementById('relaxCoeffInput')) {
                coefficients.relax = parseInt(document.getElementById('relaxCoeffInput').value) || 5;
            }
            
            // ç¡®ä¿ç³»æ•°åœ¨1-10çš„èŒƒå›´å†…
            coefficients.main = Math.max(1, Math.min(10, coefficients.main));
            coefficients.other = Math.max(1, Math.min(10, coefficients.other));
            coefficients.exercise = Math.max(1, Math.min(10, coefficients.exercise));
            coefficients.relax = Math.max(1, Math.min(10, coefficients.relax));
            
            // åŒæ­¥è¾“å…¥å€¼
            syncInputValues();
            
            // æ›´æ–°æ•ˆèƒ½ç³»æ•°å›¾è¡¨
            updateEfficiencyBars();
            
            // æ›´æ–°å…¬å¼æ˜¾ç¤º
            updateObjectiveFunction();
            
            // æ›´æ–°UI
            updateUI();
        }
        
        // ============== è·å–å½“å‰çº¦æŸæ¡ä»¶ ==============
        function getConstraints() {
            // è·å–ä¸»ç§‘å’Œç»¼åˆç§‘ç›®çš„æœ€ä½å­¦ä¹ æ—¶é—´
            const mainMinTime = parseFloat(document.getElementById('mainSubject').value);
            const otherMinTime = parseFloat(document.getElementById('otherSubject').value);
            
            return {
                mainMinTime,
                otherMinTime,
                totalTime
            };
        }
        
        // ============== è®¡ç®—å¯è¡ŒåŸŸé¡¶ç‚¹ ==============
        function calculateVertices() {
            const constraints = getConstraints();
            const vertices = [];
            
            // è·å–çº¦æŸæ¡ä»¶
            const mainMin = constraints.mainMinTime;
            const otherMin = constraints.otherMinTime;
            const maxSum = totalTime - (fixedActivities.exercise + fixedActivities.relax);
            
            // è€ƒè™‘å››æ¡çº¿çš„äº¤ç‚¹ï¼šx=mainMin, y=otherMin, x+y=maxSum, x=0, y=0
            
            // æ·»åŠ  (mainMin, otherMin) é¡¶ç‚¹
            if (mainMin + otherMin <= maxSum) {
                vertices.push([mainMin, otherMin]);
            }
            
            // æ·»åŠ  (mainMin, maxSum-mainMin) é¡¶ç‚¹
            if (maxSum - mainMin >= otherMin) {
                vertices.push([mainMin, maxSum - mainMin]);
            }
            
            // æ·»åŠ  (maxSum-otherMin, otherMin) é¡¶ç‚¹
            if (maxSum - otherMin >= mainMin) {
                vertices.push([maxSum - otherMin, otherMin]);
            }
            
            return vertices;
        }
        
        // ============== å¯»æ‰¾æœ€ä¼˜è§£ ==============
        function findOptimalSolution() {
            const vertices = calculateVertices();
            if (vertices.length === 0) {
                return null;
            }
            
            let optimalPoint = null;
            let maxValue = -Infinity;
            
            // ç›®æ ‡å‡½æ•°: Z = coefficients.main * x + coefficients.other * y + å›ºå®šæ´»åŠ¨çš„æ•ˆç›Š
            vertices.forEach(vertex => {
                const [x, y] = vertex;
                const value = coefficients.main * x + coefficients.other * y + 
                             coefficients.exercise * fixedActivities.exercise + 
                             coefficients.relax * fixedActivities.relax;
                
                if (value > maxValue) {
                    maxValue = value;
                    optimalPoint = {
                        x: x,
                        y: y,
                        value: value
                    };
                }
            });
            
            return optimalPoint;
        }
        
        // ============== æ›´æ–°é¡¶ç‚¹åˆ—è¡¨ ==============
        function updateVerticesList() {
            const vertices = calculateVertices();
            const verticesGrid = document.getElementById('vertices-grid');
            const noVerticesMessage = document.getElementById('no-vertices-message');
            const verticesList = document.getElementById('vertices-list');
            
            // æ¸…ç©ºç°æœ‰å†…å®¹
            verticesGrid.innerHTML = '';
            
            if (vertices.length === 0) {
                noVerticesMessage.style.display = 'block';
                verticesList.style.display = 'none';
                return;
            }
            
            noVerticesMessage.style.display = 'none';
            verticesList.style.display = 'block';
            
            // è®¡ç®—æ¯ä¸ªé¡¶ç‚¹çš„ç›®æ ‡å‡½æ•°å€¼
            vertices.forEach((vertex, index) => {
                const [x, y] = vertex;
                const value = coefficients.main * x + coefficients.other * y + 
                              coefficients.exercise * fixedActivities.exercise + 
                              coefficients.relax * fixedActivities.relax;
                
                const vertexCard = document.createElement('div');
                vertexCard.style.padding = '10px';
                vertexCard.style.background = '#fff';
                vertexCard.style.borderRadius = '4px';
                vertexCard.style.boxShadow = '0 1px 3px rgba(0,0,0,0.1)';
                
                vertexCard.innerHTML = `
                    <div style="font-weight: 500; margin-bottom: 5px;">é¡¶ç‚¹ ${index + 1}</div>
                    <div style="font-size: 13px; color: #666; margin-bottom: 3px;">ä¸»ç§‘ (x): ${x.toFixed(1)} å°æ—¶</div>
                    <div style="font-size: 13px; color: #666; margin-bottom: 3px;">ç»¼åˆ (y): ${y.toFixed(1)} å°æ—¶</div>
                    <div style="margin-top: 5px; font-weight: 500; color: #1890ff;">æ•ˆç›Šå€¼: ${value.toFixed(1)}</div>
                `;
                
                verticesGrid.appendChild(vertexCard);
            });
        }
        
        // ============== åˆ‡æ¢é¡¶ç‚¹æ˜¾ç¤º ==============
        function toggleVertex() {
            showVertices = !showVertices;
            const btnText = document.getElementById('vertex-btn-text');
            
            if (showVertices) {
                btnText.textContent = 'éšè—é¡¶ç‚¹åæ ‡';
                updateVerticesList();
            } else {
                btnText.textContent = 'æ˜¾ç¤ºé¡¶ç‚¹åæ ‡';
                document.getElementById('vertices-list').style.display = 'none';
            }
        }
        
        // ============== æ™ºèƒ½ç¼©æ”¾è§†å›¾ ==============
        function autoZoom() {
            customZoom = true;
            
            // è·å–çº¦æŸæ¡ä»¶
            const constraints = getConstraints();
            const mainMin = constraints.mainMinTime;
            const otherMin = constraints.otherMinTime;
            const maxSum = totalTime - (fixedActivities.exercise + fixedActivities.relax);
            
            // è®¾ç½®åˆé€‚çš„ç¼©æ”¾å› å­
            zoomFactor.x = Math.max(mainMin, maxSum - otherMin) * 1.3;
            zoomFactor.y = Math.max(otherMin, maxSum - mainMin) * 1.3;
            
            // ç¡®ä¿æœ€å°ç¼©æ”¾
            zoomFactor.x = Math.max(zoomFactor.x, 3);
            zoomFactor.y = Math.max(zoomFactor.y, 3);
            
            updateUI();
        }
        
        // ============== é‡ç½®è§†å›¾ ==============
        function resetZoom() {
            customZoom = false;
            zoomFactor = { x: 4, y: 4 };
            updateUI();
        }
        
        // ============== æ¸²æŸ“å›¾è¡¨ ==============
        function renderChart() {
            if (!myChart) {
                console.error("å›¾è¡¨å®ä¾‹ä¸å­˜åœ¨ï¼Œå°è¯•é‡æ–°åˆå§‹åŒ–");
                initChart();
                if (!myChart) {
                    console.error("å›¾è¡¨åˆå§‹åŒ–å¤±è´¥");
                    return;
                }
            }
            
            try {
                const constraints = getConstraints();
                const mainMin = constraints.mainMinTime;
                const otherMin = constraints.otherMinTime;
                const maxSum = totalTime - (fixedActivities.exercise + fixedActivities.relax);
                
                // è®¡ç®—é¡¶ç‚¹
                const vertices = calculateVertices();
                
                // ç¡®å®šå›¾è¡¨æ˜¾ç¤ºèŒƒå›´
                let xMax = customZoom ? zoomFactor.x : 4;
                let yMax = customZoom ? zoomFactor.y : 4;
                
                // åˆ›å»ºå¯è¡ŒåŸŸå¤šè¾¹å½¢
                let polygonPoints = [];
                if (vertices.length > 0) {
                    // æŒ‰ç…§é€†æ—¶é’ˆæˆ–é¡ºæ—¶é’ˆæ’åºé¡¶ç‚¹
                    vertices.sort((a, b) => {
                        const angleA = Math.atan2(a[1] - otherMin, a[0] - mainMin);
                        const angleB = Math.atan2(b[1] - otherMin, b[0] - mainMin);
                        return angleA - angleB;
                    });
                    
                    polygonPoints = vertices.map(vertex => [vertex[0], vertex[1]]);
                }
                
                // å‡†å¤‡æœ€ä¼˜è§£æ•°æ®ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
                let optimalSolution = null;
                let optimalValue = null;
                
                // å¦‚æœå½“å‰æ˜¯æ­¥éª¤4æˆ–5ï¼Œæ˜¾ç¤ºæœ€ä¼˜è§£
                if (currentActiveStep >= 4) {
                    const solution = findOptimalSolution();
                    if (solution) {
                        optimalSolution = [solution.x, solution.y];
                        optimalValue = solution.value;
                    }
                }
                
                // åˆ›å»ºç›®æ ‡å‡½æ•°ç­‰å€¼çº¿ï¼ˆå¦‚æœåœ¨æ­¥éª¤4åï¼‰
                let objectiveLines = [];
                if (currentActiveStep >= 4 && optimalSolution) {
                    // åˆ›å»ºå‡ æ¡ç›®æ ‡å‡½æ•°ç­‰å€¼çº¿
                    const optimalZ = coefficients.main * optimalSolution[0] + coefficients.other * optimalSolution[1];
                    const increment = optimalZ / 5;
                    
                    for (let i = 1; i <= 5; i++) {
                        const z = i * increment;
                        
                        // è®¡ç®—ç­‰å€¼çº¿çš„ä¸¤ä¸ªç‚¹
                        // Z = mainCoeff * x + otherCoeff * y
                        // y = (Z - mainCoeff * x) / otherCoeff
                        // å– x = 0 å’Œ x = xMax è®¡ç®—å¯¹åº”çš„ y
                        
                        // é¿å…é™¤ä»¥é›¶é”™è¯¯
                        if (coefficients.other === 0) continue;
                        
                        let y1 = (z - coefficients.main * 0) / coefficients.other;
                        let y2 = (z - coefficients.main * xMax) / coefficients.other;
                        
                        if (y1 >= 0 && y1 <= yMax && y2 >= 0 && y2 <= yMax) {
                            objectiveLines.push({
                                value: z.toFixed(1),
                                points: [[0, y1], [xMax, y2]]
                            });
                        }
                    }
                }
                
                // é…ç½®å›¾è¡¨é€‰é¡¹
                const option = {
                    animation: false,
                    title: {
                        text: currentActiveStep >= 4 ? 'çº¿æ€§è§„åˆ’å¯è§†åŒ– - æœ€ä¼˜è§£' : 'çº¿æ€§è§„åˆ’å¯è§†åŒ– - å¯è¡ŒåŸŸ',
                        left: 'center',
                        top: 10,
                        textStyle: {
                            fontSize: 16,
                            fontWeight: 'normal'
                        }
                    },
                    tooltip: {
                        formatter: function(params) {
                            if (params.seriesName === 'æœ€ä¼˜è§£') {
                                return 'æœ€ä¼˜è§£: (' + params.data[0].toFixed(1) + ', ' + params.data[1].toFixed(1) + ')<br/>æ•ˆç›Šå€¼: ' + (optimalValue ? optimalValue.toFixed(1) : '0.0');
                            } else if (params.seriesName === 'é¡¶ç‚¹') {
                                return 'é¡¶ç‚¹: (' + params.data[0].toFixed(1) + ', ' + params.data[1].toFixed(1) + ')';
                            }
                            return params.seriesName;
                        }
                    },
                    grid: {
                        left: '10%',
                        right: '10%',
                        top: 60,
                        bottom: 60
                    },
                    xAxis: {
                        type: 'value',
                        name: 'ä¸»ç§‘æ—¶é—´ (å°æ—¶)',
                        nameLocation: 'middle',
                        nameGap: 30,
                        min: 0,
                        max: xMax,
                        axisLine: {
                            lineStyle: { color: '#666' }
                        },
                        splitLine: {
                            show: true,
                            lineStyle: { type: 'dashed', color: '#ddd' }
                        }
                    },
                    yAxis: {
                        type: 'value',
                        name: 'ç»¼åˆç§‘ç›®æ—¶é—´ (å°æ—¶)',
                        nameLocation: 'middle',
                        nameGap: 30,
                        min: 0,
                        max: yMax,
                        axisLine: {
                            lineStyle: { color: '#666' }
                        },
                        splitLine: {
                            show: true,
                            lineStyle: { type: 'dashed', color: '#ddd' }
                        }
                    },
                    series: []
                };
                
                // çº¦æŸçº¿ - ä¸»ç§‘æœ€å°æ—¶é—´
                option.series.push({
                    name: 'ä¸»ç§‘æœ€å°æ—¶é—´',
                    type: 'line',
                    symbolSize: 0,
                    lineStyle: { color: '#1890ff', width: 2 },
                    data: [[mainMin, 0], [mainMin, yMax]],
                    markArea: {
                        itemStyle: {
                            color: 'rgba(24, 144, 255, 0.1)',
                            borderWidth: 0
                        },
                        data: [
                            [{
                                coord: [mainMin, 0]
                            }, {
                                coord: [xMax, yMax]
                            }]
                        ]
                    }
                });
                
                // çº¦æŸçº¿ - ç»¼åˆç§‘ç›®æœ€å°æ—¶é—´
                option.series.push({
                    name: 'ç»¼åˆç§‘ç›®æœ€å°æ—¶é—´',
                    type: 'line',
                    symbolSize: 0,
                    lineStyle: { color: '#52c41a', width: 2 },
                    data: [[0, otherMin], [xMax, otherMin]],
                    markArea: {
                        itemStyle: {
                            color: 'rgba(82, 196, 26, 0.1)',
                            borderWidth: 0
                        },
                        data: [
                            [{
                                coord: [0, otherMin]
                            }, {
                                coord: [xMax, yMax]
                            }]
                        ]
                    }
                });
                
                // çº¦æŸçº¿ - æ€»æ—¶é—´é™åˆ¶
                option.series.push({
                    name: 'æ€»æ—¶é—´é™åˆ¶',
                    type: 'line',
                    symbolSize: 0,
                    lineStyle: { color: '#ff4d4f', width: 2 },
                    data: [[0, maxSum], [maxSum, 0]],
                    markArea: {
                        itemStyle: {
                            color: 'rgba(255, 77, 79, 0.1)',
                            borderWidth: 0
                        },
                        data: [
                            [{
                                coord: [0, 0]
                            }, {
                                coord: [xMax, maxSum]
                            }]
                        ]
                    }
                });
                
                // å¯è¡ŒåŸŸå¤šè¾¹å½¢ï¼ˆå¦‚æœæœ‰é¡¶ç‚¹ï¼‰
                if (polygonPoints.length > 0) {
                    option.series.push({
                        name: 'å¯è¡ŒåŸŸ',
                        type: 'polygon',
                        emphasis: { disabled: true },
                        itemStyle: {
                            color: 'rgba(0, 200, 0, 0.2)',
                            borderColor: 'rgba(0, 200, 0, 0.8)',
                            borderWidth: 2
                        },
                        data: [polygonPoints]
                    });
                }
                
                // é¡¶ç‚¹
                if (currentActiveStep >= 3 && showVertices && vertices.length > 0) {
                    option.series.push({
                        name: 'é¡¶ç‚¹',
                        type: 'scatter',
                        symbolSize: 10,
                        itemStyle: { color: '#1890ff' },
                        data: vertices
                    });
                }
                
                // å¦‚æœæœ‰æœ€ä¼˜è§£ï¼Œæ·»åŠ æœ€ä¼˜è§£ç‚¹
                if (currentActiveStep >= 4 && optimalSolution) {
                    option.series.push({
                        name: 'æœ€ä¼˜è§£',
                        type: 'scatter',
                        symbolSize: 15,
                        itemStyle: { color: '#ff4d4f' },
                        data: [optimalSolution]
                    });
                    
                    // æ·»åŠ æœ€ä¼˜è§£æ ‡ç­¾
                    option.series.push({
                        name: 'æœ€ä¼˜è§£æ ‡ç­¾',
                        type: 'scatter',
                        symbolSize: 0,
                        label: {
                            show: true,
                            position: 'top',
                            formatter: 'æœ€ä¼˜è§£\n(' + optimalSolution[0].toFixed(1) + ', ' + optimalSolution[1].toFixed(1) + ')',
                            color: '#ff4d4f',
                            backgroundColor: 'rgba(255, 255, 255, 0.7)',
                            padding: 5,
                            borderRadius: 3
                        },
                        data: [optimalSolution]
                    });
                    
                    // æ·»åŠ ç›®æ ‡å‡½æ•°ç­‰å€¼çº¿
                    objectiveLines.forEach((line, index) => {
                        option.series.push({
                            name: 'ç­‰å€¼çº¿ Z=' + line.value,
                            type: 'line',
                            symbolSize: 0,
                            lineStyle: { 
                                color: '#722ed1', 
                                width: index === objectiveLines.length - 1 ? 2 : 1,
                                type: index === objectiveLines.length - 1 ? 'solid' : 'dashed'
                            },
                            data: line.points
                        });
                    });
                }
                
                // è®¾ç½®å›¾è¡¨é€‰é¡¹
                myChart.setOption(option, true);
                
            } catch (e) {
                console.error("æ¸²æŸ“å›¾è¡¨é”™è¯¯è¯¦æƒ…:", e);
                // å°è¯•ç®€å•å›¾è¡¨æ¸²æŸ“
                try {
                    myChart.setOption({
                        title: {
                            text: 'å›¾è¡¨æ¸²æŸ“å¤±è´¥ - ç®€å•å›¾è¡¨',
                            left: 'center'
                        },
                        xAxis: {
                            type: 'value',
                            min: 0,
                            max: 5
                        },
                        yAxis: {
                            type: 'value',
                            min: 0,
                            max: 5
                        },
                        series: [{
                            data: [[1, 1]],
                            type: 'scatter'
                        }]
                    });
                } catch (fallbackError) {
                    console.error("ç®€å•å›¾è¡¨ä¹Ÿæ¸²æŸ“å¤±è´¥:", fallbackError);
                }
            }
        }
        
        // ============== æ­¥éª¤åˆ‡æ¢ ==============
        function switchStep(step) {
            // éšè—æ‰€æœ‰æ­¥éª¤å†…å®¹
            document.querySelectorAll('.step-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // æ˜¾ç¤ºé€‰å®šæ­¥éª¤å†…å®¹
            document.getElementById('step-content-' + step).classList.add('active');
            
            // æ›´æ–°æ­¥éª¤æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.step-button').forEach((btn, index) => {
                btn.classList.remove('active', 'completed');
                
                // å½“å‰æ­¥éª¤ä¸ºæ´»åŠ¨çŠ¶æ€
                if (index + 1 === step) {
                    btn.classList.add('active');
                    btn.querySelector('.step-status').textContent = 'è¿›è¡Œä¸­';
                } 
                // ä¹‹å‰æ­¥éª¤ä¸ºå®ŒæˆçŠ¶æ€
                else if (index + 1 < step) {
                    btn.classList.add('completed');
                    btn.querySelector('.step-status').textContent = 'å·²å®Œæˆ';
                } 
                // ä¹‹åæ­¥éª¤ä¸ºå¾…å®ŒæˆçŠ¶æ€
                else {
                    btn.querySelector('.step-status').textContent = 'å¾…å®Œæˆ';
                }
            });
            
            // æ›´æ–°å½“å‰æ´»åŠ¨æ­¥éª¤
            currentActiveStep = step;
            
            // æ›´æ–°UI
            updateUI();
        }
        
        // ============== ä¸‹ä¸€æ­¥ ==============
        function nextStep() {
            if (currentActiveStep < 5) {
                switchStep(currentActiveStep + 1);
            }
        }
        
        // ============== ä¸Šä¸€æ­¥ ==============
        function prevStep() {
            if (currentActiveStep > 1) {
                switchStep(currentActiveStep - 1);
            }
        }
        
        // ============== è®¡ç®—æ—¶é—´åˆ†é… ==============
        function calculateTimeAllocation() {
            const optimalSolution = findOptimalSolution();
            if (!optimalSolution) return null;
            
            return {
                main: optimalSolution.x.toFixed(1),
                other: optimalSolution.y.toFixed(1),
                exercise: fixedActivities.exercise.toFixed(1),
                relax: fixedActivities.relax.toFixed(1),
                total: (optimalSolution.x + optimalSolution.y + fixedActivities.exercise + fixedActivities.relax).toFixed(1),
                value: optimalSolution.value.toFixed(1)
            };
        }
        
        // ============== æ›´æ–°æ—¶é—´åˆ†é…å›¾è¡¨ ==============
        function updateTimeAllocationChart() {
            try {
                const allocation = calculateTimeAllocation();
                if (!allocation) return;
                
                // æŸ¥æ‰¾æ‰€æœ‰éœ€è¦çš„å…ƒç´ 
                const segmentMain = document.querySelector('.segment-main');
                const segmentOther = document.querySelector('.segment-other');
                const segmentExercise = document.querySelector('.segment-exercise');
                const segmentRelax = document.querySelector('.segment-relax');
                const totalValueElement = document.getElementById('total-value');
                
                // å¦‚æœä»»ä½•å…ƒç´ ä¸å­˜åœ¨åˆ™é€€å‡º
                if (!segmentMain || !segmentOther || !segmentExercise || !segmentRelax) {
                    console.error("æ— æ³•æ‰¾åˆ°æ—¶é—´æ¡çš„æ‰€æœ‰æ®µå…ƒç´ ");
                    return;
                }
                
                // è®¡ç®—æ¯ä¸ªæ´»åŠ¨çš„ç™¾åˆ†æ¯”å®½åº¦
                const totalWidth = 100;
                const mainWidth = (allocation.main / allocation.total) * totalWidth;
                const otherWidth = (allocation.other / allocation.total) * totalWidth;
                const exerciseWidth = (allocation.exercise / allocation.total) * totalWidth;
                const relaxWidth = (allocation.relax / allocation.total) * totalWidth;
                
                // è®¾ç½®æ¯ä¸ªæ—¶é—´æ®µçš„å®½åº¦
                segmentMain.style.width = mainWidth + '%';
                segmentOther.style.width = otherWidth + '%';
                segmentExercise.style.width = exerciseWidth + '%';
                segmentRelax.style.width = relaxWidth + '%';
                
                // æ›´æ–°æ—¶é—´æ–‡æœ¬
                segmentMain.innerHTML = `${allocation.main}h`;
                segmentOther.innerHTML = `${allocation.other}h`;
                segmentExercise.innerHTML = `${allocation.exercise}h`;
                segmentRelax.innerHTML = `${allocation.relax}h`;
                
                // æ›´æ–°æ€»æ•ˆç›Šå€¼
                if (totalValueElement) {
                    totalValueElement.textContent = allocation.value;
                }
            } catch (e) {
                console.error("æ›´æ–°æ—¶é—´åˆ†é…å›¾è¡¨é”™è¯¯:", e);
            }
        }
        
        // ============== æ›´æ–°æœ€ä¼˜è§£æ˜¾ç¤º ==============
        function updateOptimalSolutionDisplay() {
            // æ£€æŸ¥æ‰€éœ€çš„DOMå…ƒç´ æ˜¯å¦å­˜åœ¨
            if (!document.getElementById('optimal-solution-card') || 
                !document.getElementById('no-solution-message') ||
                !document.getElementById('time-allocation-card')) {
                return;
            }
            
            const solution = findOptimalSolution();
            const optimalSolutionCard = document.getElementById('optimal-solution-card');
            const noSolutionMessage = document.getElementById('no-solution-message');
            const timeAllocationCard = document.getElementById('time-allocation-card');
            
            // æ›´æ–°ç›®æ ‡å‡½æ•°æ˜¾ç¤º
            if (document.getElementById('optimal-function-text')) {
                document.getElementById('optimal-function-text').textContent = 
                    `${coefficients.main}x + ${coefficients.other}y + ${coefficients.exercise * fixedActivities.exercise + coefficients.relax * fixedActivities.relax}`;
            }
            
            // å¦‚æœæ²¡æœ‰è§£ï¼Œæ˜¾ç¤ºæ— è§£æ¶ˆæ¯
            if (!solution) {
                optimalSolutionCard.style.display = 'none';
                noSolutionMessage.style.display = 'block';
                timeAllocationCard.style.display = 'none';
                return;
            }
            
            // æ˜¾ç¤ºæœ€ä¼˜è§£
            optimalSolutionCard.style.display = 'block';
            noSolutionMessage.style.display = 'none';
            timeAllocationCard.style.display = 'block';
            
            // æ›´æ–°æœ€ä¼˜è§£åæ ‡å’Œæ•ˆç›Šå€¼
            if (document.getElementById('optimal-x')) {
                document.getElementById('optimal-x').textContent = solution.x.toFixed(1);
            }
            if (document.getElementById('optimal-y')) {
                document.getElementById('optimal-y').textContent = solution.y.toFixed(1);
            }
            if (document.getElementById('optimal-value')) {
                document.getElementById('optimal-value').textContent = solution.value.toFixed(1);
            }
            
            // æ›´æ–°æ—¶é—´åˆ†é…æ˜¾ç¤º
            if (document.getElementById('total-time-value')) {
                document.getElementById('total-time-value').textContent = totalTime.toFixed(1);
            }
            if (document.getElementById('main-time-value')) {
                document.getElementById('main-time-value').textContent = solution.x.toFixed(1) + 'å°æ—¶';
            }
            if (document.getElementById('other-time-value')) {
                document.getElementById('other-time-value').textContent = solution.y.toFixed(1) + 'å°æ—¶';
            }
            
            // æ›´æ–°æ—¶é—´åˆ†é…å›¾è¡¨
            try {
                if (document.querySelector('.time-bar')) {
                    updateTimeAllocationChart();
                }
            } catch (e) {
                console.log("æ›´æ–°æ—¶é—´åˆ†é…å›¾è¡¨å¤±è´¥:", e);
            }
            
            // ä¸å†è‡ªåŠ¨è°ƒç”¨ updateComparisonData
        }
        
        // ============== æ ‡ç­¾é¡µåˆ‡æ¢ ==============
        function switchTab(tabId) {
            console.log("åˆ‡æ¢åˆ°æ ‡ç­¾é¡µ:", tabId);
            // æ›´æ–°æ ‡ç­¾æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // æ¿€æ´»é€‰å®šçš„æ ‡ç­¾é¡µ
            document.querySelector(`.tab-button[onclick="switchTab('${tabId}')"]`).classList.add('active');
            document.getElementById('tab-' + tabId).classList.add('active');
            
            // ç‰¹æ®Šå¤„ç†ï¼šå¦‚æœæ˜¯æ–¹æ¡ˆå¯¹æ¯”æ ‡ç­¾é¡µï¼Œæ›´æ–°å¯¹æ¯”æ•°æ®
            if (tabId === 'compare') {
                setTimeout(() => {
                    try {
                        console.log("å°è¯•æ›´æ–°æ¯”è¾ƒæ•°æ®...");
                        updateComparisonData();
                    } catch (e) {
                        console.error("æ›´æ–°æ¯”è¾ƒæ•°æ®æ—¶å‡ºé”™:", e);
                    }
                }, 100);
            }
            
            // å¦‚æœæ˜¯è‡ªå®šä¹‰æ¢ç´¢æ ‡ç­¾ï¼Œéœ€è¦æ£€æŸ¥æ€»æ—¶é—´æ˜¾ç¤ºæ˜¯å¦æ­£ç¡®
            if (tabId === 'custom' && document.getElementById('total-time-custom-value')) {
                document.getElementById('total-time-custom-value').textContent = totalTime.toFixed(1);
            }
            
            // å¦‚æœæ˜¯æ•æ„Ÿæ€§åˆ†æï¼Œåˆ™æ›´æ–°æ•æ„Ÿæ€§æ•°æ®
            if (tabId === 'sensitivity' && document.getElementById('main-sensitivity-value')) {
                updateSensitivity('main', document.getElementById('main-sensitivity-value').textContent);
            }
            
            // å¦‚æœéœ€è¦æ˜¾ç¤ºç»Ÿè®¡å›¾è¡¨ï¼Œåœ¨è¿™é‡Œæ¸²æŸ“ä¸åŒçš„ç»Ÿè®¡å›¾
            if (tabId === 'compare') {
                setTimeout(() => {
                    renderStatisticsChart();
                }, 200);
            }
        }
        
        // ============== æ¸²æŸ“ç»Ÿè®¡åˆ†æå›¾è¡¨ ==============
        function renderStatisticsChart() {
            console.log("æ¸²æŸ“ç»Ÿè®¡åˆ†æå›¾è¡¨...");
            const statisticsChart = document.getElementById('statistics-chart');
            if (!statisticsChart) {
                console.error("ç»Ÿè®¡åˆ†æå›¾è¡¨å®¹å™¨ä¸å­˜åœ¨");
                return;
            }
            
            try {
                // æ£€æŸ¥æ˜¯å¦å·²ç»æœ‰å›¾è¡¨å®ä¾‹
                if (window.statsChart && window.statsChart.dispose) {
                    window.statsChart.dispose();
                }
                
                // åˆ›å»ºæ–°å›¾è¡¨å®ä¾‹
                window.statsChart = echarts.init(statisticsChart);
                
                // è·å–æœ€ä¼˜è§£å’Œå¹³å‡åˆ†é…æ–¹æ¡ˆ
                const solution = findOptimalSolution();
                if (!solution) {
                    console.error("æ— æ³•è·å–æœ€ä¼˜è§£ï¼Œæ— æ³•æ¸²æŸ“ç»Ÿè®¡å›¾è¡¨");
                    return;
                }
                
                const maxSum = totalTime - (fixedActivities.exercise + fixedActivities.relax);
                const avgX = maxSum / 2;
                const avgY = maxSum / 2;
                const avgValue = coefficients.main * avgX + coefficients.other * avgY + 
                               coefficients.exercise * fixedActivities.exercise + 
                               coefficients.relax * fixedActivities.relax;
                
                // è®¾ç½®å›¾è¡¨é€‰é¡¹
                const option = {
                    title: {
                        text: 'æ–¹æ¡ˆæ•ˆç›Šå¯¹æ¯”',
                        left: 'center'
                    },
                    tooltip: {
                        trigger: 'axis',
                        axisPointer: {
                            type: 'shadow'
                        },
                        formatter: function(params) {
                            const value = params[0].value;
                            return params[0].name + ': ' + value.toFixed(1) + 'åˆ†';
                        }
                    },
                    legend: {
                        data: ['æ–¹æ¡ˆæ•ˆç›Šå€¼'],
                        bottom: 0
                    },
                    grid: {
                        left: '3%',
                        right: '4%',
                        top: '15%',
                        bottom: '15%',
                        containLabel: true
                    },
                    xAxis: {
                        type: 'category',
                        data: ['æœ€ä¼˜æ–¹æ¡ˆ', 'å¹³å‡åˆ†é…']
                    },
                    yAxis: {
                        type: 'value',
                        name: 'æ•ˆç›Šå€¼'
                    },
                    series: [
                        {
                            name: 'æ–¹æ¡ˆæ•ˆç›Šå€¼',
                            type: 'bar',
                            data: [
                                {value: solution.value, itemStyle: {color: '#1890ff'}},
                                {value: avgValue, itemStyle: {color: '#52c41a'}}
                            ],
                            label: {
                                show: true,
                                position: 'top',
                                formatter: '{c} åˆ†'
                            }
                        }
                    ]
                };
                
                // è®¾ç½®å›¾è¡¨
                window.statsChart.setOption(option);
                console.log("ç»Ÿè®¡åˆ†æå›¾è¡¨æ¸²æŸ“å®Œæˆ");
                
            } catch (e) {
                console.error("æ¸²æŸ“ç»Ÿè®¡åˆ†æå›¾è¡¨é”™è¯¯:", e);
            }
        }
        
        // ============== æ›´æ–°æ–¹æ¡ˆå¯¹æ¯”æ•°æ® ==============
        function updateComparisonData() {
            try {
                console.log("æ›´æ–°æ–¹æ¡ˆå¯¹æ¯”æ•°æ®...");
                // å¼ºåˆ¶æ£€æŸ¥æ‰€éœ€çš„DOMå…ƒç´ æ˜¯å¦å­˜åœ¨ï¼Œè‹¥ä¸å­˜åœ¨åˆ™ç›´æ¥è¿”å›
                if (!document.getElementById('optimal-x-compare')) {
                    console.error("æ‰¾ä¸åˆ°optimal-x-compareå…ƒç´ ");
                    return;
                }
                if (!document.getElementById('optimal-y-compare')) {
                    console.error("æ‰¾ä¸åˆ°optimal-y-compareå…ƒç´ ");
                    return;
                }
                if (!document.getElementById('optimal-value-compare')) {
                    console.error("æ‰¾ä¸åˆ°optimal-value-compareå…ƒç´ ");
                    return;
                }
                if (!document.getElementById('average-x-compare')) {
                    console.error("æ‰¾ä¸åˆ°average-x-compareå…ƒç´ ");
                    return;
                }
                if (!document.getElementById('average-y-compare')) {
                    console.error("æ‰¾ä¸åˆ°average-y-compareå…ƒç´ ");
                    return;
                }
                if (!document.getElementById('average-value-compare')) {
                    console.error("æ‰¾ä¸åˆ°average-value-compareå…ƒç´ ");
                    return;
                }
                if (!document.getElementById('improvement-percentage')) {
                    console.error("æ‰¾ä¸åˆ°improvement-percentageå…ƒç´ ");
                    return;
                }
                
                // è·å–æœ€ä¼˜è§£
                const optimalSolution = findOptimalSolution();
                if (!optimalSolution) {
                    console.error("æ— æ³•è·å–æœ€ä¼˜è§£");
                    return;
                }
                
                // æ›´æ–°æœ€ä¼˜æ–¹æ¡ˆæ•°æ®
                document.getElementById('optimal-x-compare').textContent = optimalSolution.x.toFixed(1) + 'å°æ—¶';
                document.getElementById('optimal-y-compare').textContent = optimalSolution.y.toFixed(1) + 'å°æ—¶';
                document.getElementById('optimal-value-compare').textContent = optimalSolution.value.toFixed(1);
                
                // è®¡ç®—å¹³å‡æ–¹æ¡ˆæ•°æ®
                const maxSum = totalTime - (fixedActivities.exercise + fixedActivities.relax);
                const avgX = maxSum / 2;
                const avgY = maxSum / 2;
                const avgValue = coefficients.main * avgX + coefficients.other * avgY + 
                               coefficients.exercise * fixedActivities.exercise + 
                               coefficients.relax * fixedActivities.relax;
                
                // æ›´æ–°å¹³å‡æ–¹æ¡ˆæ•°æ®
                document.getElementById('average-x-compare').textContent = avgX.toFixed(1) + 'å°æ—¶';
                document.getElementById('average-y-compare').textContent = avgY.toFixed(1) + 'å°æ—¶';
                document.getElementById('average-value-compare').textContent = avgValue.toFixed(1);
                
                // è®¡ç®—æ”¹è¿›ç™¾åˆ†æ¯”
                const improvement = ((optimalSolution.value - avgValue) / avgValue) * 100;
                document.getElementById('improvement-percentage').textContent = improvement.toFixed(1) + '%';
                
                // æ›´æ–°åˆ†æç»“æœ
                if (document.getElementById('compare-result')) {
                    let resultText = `é€šè¿‡çº¿æ€§è§„åˆ’æ‰¾åˆ°çš„æœ€ä¼˜è§£æ¯”å¹³å‡åˆ†é…æ–¹æ¡ˆå¯ä»¥æé«˜ ${improvement.toFixed(1)}% çš„æ€»æ•ˆç›Šå€¼ã€‚`;
                    
                    if (improvement > 10) {
                        resultText += ' è¿™æ˜¯ä¸€ä¸ªæ˜¾è‘—çš„æå‡ï¼Œè¡¨æ˜æ•°å­¦ä¼˜åŒ–åœ¨æ—¶é—´ç®¡ç†ä¸­éå¸¸æœ‰ä»·å€¼ã€‚';
                    } else if (improvement > 0) {
                        resultText += ' è™½ç„¶æå‡ä¸å¤§ï¼Œä½†åœ¨é•¿æœŸå­¦ä¹ ä¸­ä»èƒ½å¸¦æ¥æ˜æ˜¾çš„ç´¯ç§¯æ•ˆç›Šã€‚';
                    } else {
                        resultText += ' åœ¨å½“å‰å‚æ•°è®¾ç½®ä¸‹ï¼Œæœ€ä¼˜è§£ä¸å¹³å‡åˆ†é…æ–¹æ¡ˆå·®å¼‚ä¸å¤§ã€‚';
                    }
                    
                    document.getElementById('compare-result').innerHTML = resultText;
                }
                
                console.log("æ–¹æ¡ˆå¯¹æ¯”æ•°æ®æ›´æ–°å®Œæˆ");
                
                // æ¸²æŸ“ç»Ÿè®¡å›¾è¡¨
                setTimeout(() => {
                    renderStatisticsChart();
                }, 100);
                
            } catch (e) {
                console.error("æ›´æ–°æ¯”è¾ƒæ•°æ®å¤±è´¥:", e);
            }
        }
        
        // ============== é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ– ==============
        window.onload = function() {
            try {
                document.getElementById('loading-overlay').style.display = 'flex';
                
                console.log("é¡µé¢åŠ è½½å®Œæˆï¼Œå¼€å§‹åˆå§‹åŒ–...");
                
                // åˆå§‹åŒ–å›¾è¡¨
                let chartInitialized = initChart();
                if (!chartInitialized) {
                    console.error("å›¾è¡¨åˆå§‹åŒ–å¤±è´¥ï¼Œå°†åœ¨3ç§’åé‡è¯•");
                    setTimeout(() => {
                        console.log("é‡æ–°å°è¯•åˆå§‹åŒ–å›¾è¡¨...");
                        initChart();
                    }, 3000);
                }
                
                // æ›´æ–°UI
                updateUI();
                
                // è®¾ç½®é»˜è®¤å€¼
                updateMainMinValue(1.5);
                updateOtherMinValue(1);
                
                // æ›´æ–°æ•ˆèƒ½ç³»æ•°å›¾è¡¨
                updateEfficiencyBars();
                
                document.getElementById('loading-overlay').style.display = 'none';
                console.log("åˆå§‹åŒ–å®Œæˆ");
            } catch (e) {
                console.error("åˆå§‹åŒ–è¿‡ç¨‹å‡ºé”™:", e);
                alert("åˆå§‹åŒ–å›¾è¡¨å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•");
                document.getElementById('loading-overlay').style.display = 'none';
            }
        };
        
        // ============== æ›´æ–°æ•æ„Ÿæ€§åˆ†æ ==============
        function updateSensitivity(type, value) {
            // ä¿å­˜å½“å‰ç³»æ•°
            const originalCoefficients = { ...coefficients };
            
            try {
                // æ›´æ–°æŒ‡å®šç±»å‹çš„ç³»æ•°
                coefficients[type] = parseInt(value);
                
                // æ›´æ–°æ˜¾ç¤º
                if (document.getElementById(type + '-sensitivity-value')) {
                    document.getElementById(type + '-sensitivity-value').textContent = value;
                }
                
                // è®¡ç®—æ–°çš„æœ€ä¼˜è§£
                const newSolution = findOptimalSolution();
                
                // æ¢å¤åŸå§‹ç³»æ•°
                coefficients = { ...originalCoefficients };
                
                // æ›´æ–°æ•æ„Ÿæ€§åˆ†æç»“æœ
                if (!document.getElementById('sensitivity-result')) {
                    console.error("æ‰¾ä¸åˆ°sensitivity-resultå…ƒç´ ");
                    return;
                }
                
                let resultText = '';
                if (!newSolution) {
                    resultText = 'ä½¿ç”¨å½“å‰ç³»æ•°å€¼æ— æ³•æ‰¾åˆ°å¯è¡Œè§£ã€‚è¯·å°è¯•å…¶ä»–å€¼æˆ–è°ƒæ•´çº¦æŸæ¡ä»¶ã€‚';
                } else {
                    const originalSolution = findOptimalSolution();
                    
                    if (originalSolution.x.toFixed(1) === newSolution.x.toFixed(1) && 
                        originalSolution.y.toFixed(1) === newSolution.y.toFixed(1)) {
                        resultText = `å°†${type === 'main' ? 'ä¸»ç§‘' : 'ç»¼åˆç§‘ç›®'}æ•ˆèƒ½ç³»æ•°è°ƒæ•´ä¸º ${value} åï¼Œæœ€ä¼˜è§£ä½ç½®ä¸å˜ï¼Œä»ä¸º (${newSolution.x.toFixed(1)}, ${newSolution.y.toFixed(1)})ã€‚`;
                    } else {
                        resultText = `å°†${type === 'main' ? 'ä¸»ç§‘' : 'ç»¼åˆç§‘ç›®'}æ•ˆèƒ½ç³»æ•°è°ƒæ•´ä¸º ${value} åï¼Œæœ€ä¼˜è§£ä» (${originalSolution.x.toFixed(1)}, ${originalSolution.y.toFixed(1)}) å˜ä¸º (${newSolution.x.toFixed(1)}, ${newSolution.y.toFixed(1)})ã€‚`;
                    }
                    
                    resultText += ` æ€»æ•ˆç›Šå€¼ä» ${originalSolution.value.toFixed(1)} å˜ä¸º ${newSolution.value.toFixed(1)}ã€‚`;
                    
                    // è®¡ç®—æ˜¯å¦æœ‰ä¸´ç•Œç‚¹
                    const ratio = coefficients.main / coefficients.other;
                    if (Math.abs(ratio - 1) < 0.1) {
                        resultText += ' å½“å‰ç³»æ•°æ¯”æ¥è¿‘ 1:1ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸´ç•Œç‚¹ï¼Œå¤šä¸ªé¡¶ç‚¹å¯èƒ½æœ‰ç›¸åŒçš„æ•ˆç›Šå€¼ã€‚';
                    }
                }
                
                document.getElementById('sensitivity-result').textContent = resultText;
            } catch (e) {
                console.error("æ›´æ–°æ•æ„Ÿæ€§åˆ†æé”™è¯¯:", e);
                // æ¢å¤åŸå§‹ç³»æ•°
                coefficients = { ...originalCoefficients };
            }
        }
        
        // ============== æ›´æ–°æ€»æ—¶é—´ ==============
        function updateTotalTime(value) {
            try {
                const customValue = parseFloat(value);
                if (document.getElementById('total-time-custom-value')) {
                    document.getElementById('total-time-custom-value').textContent = customValue.toFixed(1);
                }
            } catch (e) {
                console.error("æ›´æ–°æ€»æ—¶é—´é”™è¯¯:", e);
            }
        }
        
        // ============== æ›´æ–°ä¸»ç§‘è‡ªå®šä¹‰ä¸‹é™ ==============
        function updateMainSubjectCustom(value) {
            try {
                const customValue = parseFloat(value);
                
                // æ›´æ–°UIå…ƒç´ 
                if (document.getElementById('mainSubjectCustom')) {
                    document.getElementById('mainSubjectCustom').value = customValue;
                }
                if (document.getElementById('mainSubjectCustomInput')) {
                    document.getElementById('mainSubjectCustomInput').value = customValue;
                }
            } catch (e) {
                console.error("æ›´æ–°ä¸»ç§‘è‡ªå®šä¹‰ä¸‹é™é”™è¯¯:", e);
            }
        }
        
        // ============== æ›´æ–°ç»¼åˆç§‘ç›®è‡ªå®šä¹‰ä¸‹é™ ==============
        function updateOtherSubjectCustom(value) {
            try {
                const customValue = parseFloat(value);
                
                // æ›´æ–°UIå…ƒç´ 
                if (document.getElementById('otherSubjectCustom')) {
                    document.getElementById('otherSubjectCustom').value = customValue;
                }
                if (document.getElementById('otherSubjectCustomInput')) {
                    document.getElementById('otherSubjectCustomInput').value = customValue;
                }
            } catch (e) {
                console.error("æ›´æ–°ç»¼åˆç§‘ç›®è‡ªå®šä¹‰ä¸‹é™é”™è¯¯:", e);
            }
        }
        
        // ============== æ›´æ–°è‡ªå®šä¹‰æ¢ç´¢ ==============
        function updateCustomExploration() {
            try {
                // ä¿å­˜åŸå§‹å€¼
                const originalTotalTime = totalTime;
                
                // è·å–è‡ªå®šä¹‰å€¼
                if (!document.getElementById('total-time-custom-value') ||
                    !document.getElementById('mainSubject') ||
                    !document.getElementById('otherSubject') ||
                    !document.getElementById('mainSubjectCustom') ||
                    !document.getElementById('otherSubjectCustom') ||
                    !document.getElementById('custom-exploration-result')) {
                    console.error("è‡ªå®šä¹‰æ¢ç´¢æ‰€éœ€å…ƒç´ ä¸å­˜åœ¨");
                    return;
                }
                
                const originalMainMin = parseFloat(document.getElementById('mainSubject').value);
                const originalOtherMin = parseFloat(document.getElementById('otherSubject').value);
                const customTotalTime = parseFloat(document.getElementById('total-time-custom-value').textContent);
                const customMainMin = parseFloat(document.getElementById('mainSubjectCustom').value);
                const customOtherMin = parseFloat(document.getElementById('otherSubjectCustom').value);
                
                // åº”ç”¨æ–°å€¼
                totalTime = customTotalTime;
                
                // æ›´æ–°ä¸»ç§‘å’Œç»¼åˆç§‘ç›®æœ€ä½æ—¶é—´
                updateMainSubject(customMainMin);
                updateOtherSubject(customOtherMin);
                
                // è®¡ç®—æ–°çš„æœ€ä¼˜è§£
                const newSolution = findOptimalSolution();
                
                // æ›´æ–°æ¢ç´¢ç»“æœ
                let resultText = '';
                if (!newSolution) {
                    resultText = 'ä½¿ç”¨å½“å‰å‚æ•°è®¾ç½®æ— æ³•æ‰¾åˆ°å¯è¡Œè§£ã€‚è¯·å°è¯•å…¶ä»–å€¼ã€‚';
                } else {
                    resultText = 'ä½¿ç”¨å½“å‰å‚æ•°è®¾ç½®ï¼Œæœ€ä¼˜è§£ä¸º (' + newSolution.x.toFixed(1) + ', ' + newSolution.y.toFixed(1) + ')ï¼Œæ€»æ•ˆç›Šå€¼ä¸º ' + newSolution.value.toFixed(1) + 'ã€‚';
                    
                    if (customTotalTime > originalTotalTime) {
                        resultText += ' å¢åŠ æ€»æ—¶é—´é™åˆ¶å¯¼è‡´æ€»æ•ˆç›Šå€¼ä¸Šå‡ã€‚';
                    } else if (customTotalTime < originalTotalTime) {
                        resultText += ' å‡å°‘æ€»æ—¶é—´é™åˆ¶å¯¼è‡´æ€»æ•ˆç›Šå€¼ä¸‹é™ã€‚';
                    }
                    
                    if (customMainMin > originalMainMin || customOtherMin > originalOtherMin) {
                        resultText += ' æé«˜æœ€ä½æ—¶é—´è¦æ±‚é€šå¸¸ä¼šé™åˆ¶å¯è¡ŒåŸŸï¼Œå¯èƒ½å¯¼è‡´æ•ˆç›Šä¸‹é™ã€‚';
                    }
                }
                
                document.getElementById('custom-exploration-result').innerHTML = '<p>' + resultText + '</p>';
                
                // æ›´æ–°UI
                updateUI();
            } catch (e) {
                console.error("æ›´æ–°è‡ªå®šä¹‰æ¢ç´¢é”™è¯¯:", e);
            }
        }
        
        // ============== é‡ç½®è‡ªå®šä¹‰æ¢ç´¢ ==============
        function resetCustomExploration() {
            try {
                // æ£€æŸ¥æ‰€éœ€å…ƒç´ 
                if (!document.getElementById('total-time-custom-value') ||
                    !document.getElementById('mainSubjectCustom') ||
                    !document.getElementById('mainSubjectCustomInput') ||
                    !document.getElementById('otherSubjectCustom') ||
                    !document.getElementById('otherSubjectCustomInput') ||
                    !document.getElementById('custom-exploration-result')) {
                    console.error("é‡ç½®è‡ªå®šä¹‰æ¢ç´¢æ‰€éœ€å…ƒç´ ä¸å­˜åœ¨");
                    return;
                }
                
                // é‡ç½®ä¸ºé»˜è®¤å€¼
                totalTime = 4;
                document.getElementById('total-time-custom-value').textContent = '4.0';
                document.getElementById('mainSubjectCustom').value = 1.5;
                document.getElementById('mainSubjectCustomInput').value = 1.5;
                document.getElementById('otherSubjectCustom').value = 1.0;
                document.getElementById('otherSubjectCustomInput').value = 1.0;
                
                // åº”ç”¨è¿™äº›æ›´æ”¹
                updateMainSubject(1.5);
                updateOtherSubject(1.0);
                
                // æ›´æ–°UI
                updateUI();
                
                // æ›´æ–°è‡ªå®šä¹‰æ¢ç´¢ç»“æœ
                document.getElementById('custom-exploration-result').innerHTML = `
                    <p>å·²é‡ç½®ä¸ºé»˜è®¤å€¼ï¼Œæœ€ä¼˜è§£å·²æ›´æ–°ã€‚</p>
                    <ul style="padding-left: 20px; margin-top: 10px;">
                        <li>å¢åŠ æ€»æ—¶é—´é€šå¸¸ä¼šæé«˜æ€»æ•ˆç›Šï¼Œä½†æœ€ä¼˜åˆ†é…æ¯”ä¾‹å¯èƒ½ä¿æŒä¸å˜</li>
                        <li>å¦‚æœæŸä¸ªçº¦æŸæ¡ä»¶ä¸å†èµ·ä½œç”¨ï¼ˆéç´§çº¦æŸï¼‰ï¼Œæœ€ä¼˜è§£å¯èƒ½ä¸ä¼šæ”¹å˜</li>
                        <li>å½“ä¸€ä¸ªçº¦æŸå˜å¾—æ›´ä¸¥æ ¼æ—¶ï¼Œæ€»æ•ˆç›Šé€šå¸¸ä¼šé™ä½</li>
                        <li>æœ€ä¼˜è§£æ€»æ˜¯å‡ºç°åœ¨å¯è¡ŒåŸŸçš„é¡¶ç‚¹ä¸Š</li>
                    </ul>
                `;
            } catch (e) {
                console.error("é‡ç½®è‡ªå®šä¹‰æ¢ç´¢é”™è¯¯:", e);
            }
        }
    </script>
</body>
</html>

